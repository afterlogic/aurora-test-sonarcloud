"use strict";(globalThis["webpackChunkadmin_panel_vue_webclient"]=globalThis["webpackChunkadmin_panel_vue_webclient"]||[]).push([[5236],{5236:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Se});var s=i(6441),a=i(9835),n=i(6970);const l={class:"q-pa-lg"},o={class:"row q-mb-md"},c={class:"col text-h5"},r={class:"row q-mb-sm"},p={class:"col-2"},d={class:"q-my-sm"},m={class:"col-4"},u={class:"row"},S={class:"q-ma-sm col-1",style:{"margin-top":"10px"}},h={class:"row q-mb-sm"},E=(0,a._)("div",{class:"col-2"},null,-1),L={class:"col-8 q-mb-sm"},b={class:"row"},g={class:"col-2"},I={class:"q-my-sm"},_={class:"col-4"},T={class:"row"},v={class:"q-ma-sm col-1",style:{"margin-top":"10px"}},M={class:"row q-mb-sm"},C=(0,a._)("div",{class:"col-2"},null,-1),N={class:"col-8 q-my-sm"},F={class:"row"},w={class:"col-2"},A={class:"col-4"},R={class:"q-mx-sm q-pb-sm col-1"},W={class:"q-pt-md text-right"};function Z(e,t,i,s,Z,B){const f=(0,a.up)("q-input"),q=(0,a.up)("q-item-label"),U=(0,a.up)("q-card-section"),y=(0,a.up)("q-card"),O=(0,a.up)("q-btn"),D=(0,a.up)("q-linear-progress"),$=(0,a.up)("q-inner-loading"),G=(0,a.up)("q-scroll-area"),P=(0,a.Q2)("t");return(0,a.wg)(),(0,a.j4)(G,{class:"full-height full-width"},{default:(0,a.w5)((()=>[(0,a._)("div",l,[(0,a._)("div",o,[(0,a.wy)((0,a._)("div",c,null,512),[[P,"FILESWEBCLIENT.HEADING_SETTINGS_TAB_PERSONAL"]])]),(0,a.Wm)(y,{flat:"",bordered:"",class:"card-edit-settings"},{default:(0,a.w5)((()=>[(0,a.Wm)(U,null,{default:(0,a.w5)((()=>[(0,a._)("div",r,[(0,a._)("div",p,[(0,a._)("div",d,(0,n.zw)(e.$t("FILESWEBCLIENT.LABEL_TENANT_SPACE_LIMIT")),1)]),(0,a._)("div",m,[(0,a._)("div",u,[(0,a.Wm)(f,{outlined:"",dense:"",class:"col-5","bg-color":"white",modelValue:Z.tenantSpaceLimitMb,"onUpdate:modelValue":t[0]||(t[0]=e=>Z.tenantSpaceLimitMb=e)},null,8,["modelValue"]),(0,a.wy)((0,a._)("div",S,null,512),[[P,"COREWEBCLIENT.LABEL_MEGABYTES"]])])])]),(0,a._)("div",h,[E,(0,a._)("div",L,[(0,a.Wm)(q,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(e.$t("FILESWEBCLIENT.HINT_TENANT_SPACE_LIMIT")),1)])),_:1})])]),(0,a._)("div",b,[(0,a._)("div",g,[(0,a._)("div",I,(0,n.zw)(e.$t("FILESWEBCLIENT.LABEL_USER_SPACE_LIMIT")),1)]),(0,a._)("div",_,[(0,a._)("div",T,[(0,a.Wm)(f,{outlined:"",dense:"",class:"col-5","bg-color":"white",modelValue:Z.userSpaceLimitMb,"onUpdate:modelValue":t[1]||(t[1]=e=>Z.userSpaceLimitMb=e)},null,8,["modelValue"]),(0,a.wy)((0,a._)("div",v,null,512),[[P,"COREWEBCLIENT.LABEL_MEGABYTES"]])])])]),(0,a._)("div",M,[C,(0,a._)("div",N,[(0,a.Wm)(q,{caption:""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(e.$t("FILESWEBCLIENT.HINT_USER_SPACE_LIMIT")),1)])),_:1})])]),(0,a._)("div",F,[(0,a.wy)((0,a._)("div",w,null,512),[[P,"FILESWEBCLIENT.LABEL_ALLOCATED_SPACE"]]),(0,a._)("div",A,[(0,a._)("span",null,(0,n.zw)(Z.allocatedSpace),1),(0,a.wy)((0,a._)("span",R,null,512),[[P,"COREWEBCLIENT.LABEL_MEGABYTES"]])])])])),_:1})])),_:1}),(0,a._)("div",W,[(0,a.Wm)(O,{unelevated:"","no-caps":"",dense:"",class:"q-px-sm",ripple:!1,color:"primary",label:e.$t("COREWEBCLIENT.ACTION_SAVE"),onClick:B.save},null,8,["label","onClick"])])]),(0,a.Wm)($,{style:{"justify-content":"flex-start"},showing:Z.loading||Z.saving},{default:(0,a.w5)((()=>[(0,a.Wm)(D,{query:""})])),_:1},8,["showing"])])),_:1})}var B=i(9336),f=i(1427),q=i(4089),U=i(2456);const y={name:"FilesAdminSettingsPerTenant",data(){return{saving:!1,loading:!1,tenantSpaceLimitMb:"",userSpaceLimitMb:"",allocatedSpace:"",tenant:null}},computed:{tenantId(){return this.$store.getters["tenants/getCurrentTenantId"]}},watch:{"$store.state.tenants.tenants":{handler:function(){this.populate()},deep:!0}},beforeRouteLeave(e,t,i){this.$root.doBeforeRouteLeave(e,t,i)},mounted(){this.loading=!1,this.saving=!1,this.populate()},methods:{hasChanges(){if(this.loading)return!1;const e=q.Z.pObject(this.tenant?.completeData),t=e["FilesWebclient::TenantSpaceLimitMb"],i=e["FilesWebclient::UserSpaceLimitMb"];return q.Z.pInt(this.tenantSpaceLimitMb)!==t||q.Z.pInt(this.userSpaceLimitMb)!==i},revertChanges(){const e=q.Z.pObject(this.tenant?.completeData);this.tenantSpaceLimitMb=e["FilesWebclient::TenantSpaceLimitMb"],this.userSpaceLimitMb=e["FilesWebclient::UserSpaceLimitMb"]},populate(){const e=this.$store.getters["tenants/getTenant"](this.tenantId);e&&(void 0!==e.completeData["FilesWebclient::TenantSpaceLimitMb"]?(this.tenant=e,this.tenantSpaceLimitMb=e.completeData["FilesWebclient::TenantSpaceLimitMb"],this.userSpaceLimitMb=e.completeData["FilesWebclient::UserSpaceLimitMb"],this.allocatedSpace=e.completeData["FilesWebclient::AllocatedSpace"]):this.getSettings())},save(){if(!this.saving){this.saving=!0;const e={EntityType:"Tenant",EntityId:this.tenantId,TenantId:this.tenantId,UserSpaceLimitMb:q.Z.pInt(this.userSpaceLimitMb),TenantSpaceLimitMb:q.Z.pInt(this.tenantSpaceLimitMb)};U.Z.sendRequest({moduleName:"Files",methodName:"UpdateSettingsForEntity",parameters:e}).then((t=>{if(this.saving=!1,t){const t={"FilesWebclient::UserSpaceLimitMb":e.UserSpaceLimitMb,"FilesWebclient::TenantSpaceLimitMb":e.TenantSpaceLimitMb,"FilesWebclient::AllocatedSpace":this.allocatedSpace};this.$store.commit("tenants/setTenantCompleteData",{id:this.tenantId,data:t}),f.Z.showReport(this.$t("COREWEBCLIENT.REPORT_SETTINGS_UPDATE_SUCCESS"))}else f.Z.showError(this.$t("COREWEBCLIENT.ERROR_SAVING_SETTINGS_FAILED"))}),(e=>{this.saving=!1,f.Z.showError(B.Z.getTextFromResponse(e,this.$t("COREWEBCLIENT.ERROR_SAVING_SETTINGS_FAILED")))}))}},getSettings(){this.loading=!0;const e={EntityType:"Tenant",EntityId:this.tenantId};U.Z.sendRequest({moduleName:"Files",methodName:"GetSettingsForEntity",parameters:e}).then((e=>{if(this.loading=!1,e){const t={"FilesWebclient::UserSpaceLimitMb":q.Z.pInt(e.UserSpaceLimitMb),"FilesWebclient::TenantSpaceLimitMb":q.Z.pInt(e.TenantSpaceLimitMb),"FilesWebclient::AllocatedSpace":q.Z.pInt(e.AllocatedSpace)};this.$store.commit("tenants/setTenantCompleteData",{id:this.tenantId,data:t})}}),(e=>{f.Z.showError(B.Z.getTextFromResponse(e))}))}}};var O=i(1639),D=i(6663),$=i(4458),G=i(3190),P=i(6611),z=i(3115),Q=i(8879),V=i(854),x=i(8289),k=i(9984),j=i.n(k);const H=(0,O.Z)(y,[["render",Z]]),Y=H;j()(y,"components",{QScrollArea:D.Z,QCard:$.Z,QCardSection:G.Z,QInput:P.Z,QItemLabel:z.Z,QBtn:Q.Z,QInnerLoading:V.Z,QLinearProgress:x.Z});const J={class:"q-pa-lg"},K={class:"row q-mb-md"},X={class:"col text-h5"},ee={class:"row"},te={class:"col-2"},ie={class:"q-my-sm"},se={class:"col-5"},ae={class:"row"},ne={class:"q-ma-sm col-1"},le={class:"q-pt-md text-right"};function oe(e,t,i,s,l,o){const c=(0,a.up)("q-input"),r=(0,a.up)("q-card-section"),p=(0,a.up)("q-card"),d=(0,a.up)("q-btn"),m=(0,a.up)("q-linear-progress"),u=(0,a.up)("q-inner-loading"),S=(0,a.up)("q-scroll-area"),h=(0,a.Q2)("t");return(0,a.wg)(),(0,a.j4)(S,{class:"full-height full-width"},{default:(0,a.w5)((()=>[(0,a._)("div",J,[(0,a._)("div",K,[(0,a._)("div",X,(0,n.zw)(e.$t("FILESWEBCLIENT.HEADING_SETTINGS_TAB_PERSONAL")),1)]),(0,a.Wm)(p,{flat:"",bordered:"",class:"card-edit-settings"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a._)("div",ee,[(0,a._)("div",te,[(0,a._)("div",ie,(0,n.zw)(e.$t("FILESWEBCLIENT.LABEL_USER_SPACE_LIMIT")),1)]),(0,a._)("div",se,[(0,a._)("div",ae,[(0,a.Wm)(c,{outlined:"",dense:"",class:"col-5","bg-color":"white",modelValue:l.userSpaceLimitMb,"onUpdate:modelValue":t[0]||(t[0]=e=>l.userSpaceLimitMb=e)},null,8,["modelValue"]),(0,a.wy)((0,a._)("div",ne,null,512),[[h,"COREWEBCLIENT.LABEL_MEGABYTES"]])])])])])),_:1})])),_:1}),(0,a._)("div",le,[(0,a.Wm)(d,{unelevated:"","no-caps":"",dense:"",class:"q-px-sm",ripple:!1,color:"primary",label:e.$t("COREWEBCLIENT.ACTION_SAVE"),onClick:o.updateSettingsForEntity},null,8,["label","onClick"])])]),(0,a.Wm)(u,{style:{"justify-content":"flex-start"},showing:l.loading||l.saving},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{query:""})])),_:1},8,["showing"])])),_:1})}var ce=i(4409),re=i.n(ce),pe=i(9706);const de={name:"FilesAdminSettingsPerUser",data(){return{user:null,userSpaceLimitMb:0,loading:!1,saving:!1}},watch:{$route(e,t){this.parseRoute()}},mounted(){this.parseRoute()},beforeRouteLeave(e,t,i){this.$root.doBeforeRouteLeave(e,t,i)},methods:{parseRoute(){const e=q.Z.pPositiveInt(this.$route?.params?.id);this.user?.id!==e&&(this.user={id:e},this.populate())},populate(){this.loading=!0;const e=this.$store.getters["tenants/getCurrentTenantId"];pe.Z.getUser(e,this.user.id).then((({user:e,userId:t})=>{t===this.user.id&&(this.loading=!1,e&&re().isFunction(e?.getData)?(this.user=e,this.userSpaceLimitMb=q.Z.pInt(e.getData("Files::UserSpaceLimitMb"))):this.$emit("no-user-found"))}))},hasChanges(){const e=re().isFunction(this.user?.getData)?q.Z.pInt(this.user?.getData("Files::UserSpaceLimitMb")):0;return this.userSpaceLimitMb!==e},revertChanges(){const e=re().isFunction(this.user?.getData)?q.Z.pInt(this.user?.getData("Files::UserSpaceLimitMb")):0;this.userSpaceLimitMb=e},updateSettingsForEntity(){this.saving=!0;const e={EntityType:"User",EntityId:this.user?.id,TenantId:this.user.tenantId,UserSpaceLimitMb:this.userSpaceLimitMb};U.Z.sendRequest({moduleName:"Files",methodName:"UpdateSettingsForEntity",parameters:e}).then((t=>{this.saving=!1,t?(pe.Z.getUser(e.TenantId,e.EntityId).then((({user:t})=>{t.updateData([{field:"Files::UserSpaceLimitMb",value:e.UserSpaceLimitMb}]),this.populate()})),f.Z.showReport(this.$t("COREWEBCLIENT.REPORT_SETTINGS_UPDATE_SUCCESS"))):f.Z.showError(this.$t("COREWEBCLIENT.ERROR_SAVING_SETTINGS_FAILED"))}),(e=>{this.saving=!1,f.Z.showError(B.Z.getTextFromResponse(e,this.$t("COREWEBCLIENT.ERROR_SAVING_SETTINGS_FAILED")))}))}}},me=(0,O.Z)(de,[["render",oe]]),ue=me;j()(de,"components",{QScrollArea:D.Z,QCard:$.Z,QCardSection:G.Z,QInput:P.Z,QBtn:Q.Z,QInnerLoading:V.Z,QLinearProgress:x.Z});const Se={moduleName:"FilesWebclient",requiredModules:["Files"],init(e){s.Z.init(e)},getAdminSystemTabs(){return[{tabName:"files",tabTitle:"FILESWEBCLIENT.HEADING_BROWSER_TAB",tabRouteChildren:[{path:"files",component:()=>Promise.all([i.e(4736),i.e(3793)]).then(i.bind(i,3793))}]}]},getAdminUserTabs(){return[{tabName:"files",tabTitle:"FILESWEBCLIENT.HEADING_BROWSER_TAB",tabRouteChildren:[{path:"id/:id/files",component:ue},{path:"search/:search/id/:id/files",component:ue},{path:"page/:page/id/:id/files",component:ue},{path:"search/:search/page/:page/id/:id/files",component:ue}]}]},getAdminTenantTabs(){return[{tabName:"files",tabTitle:"FILESWEBCLIENT.HEADING_BROWSER_TAB",tabRouteChildren:[{path:"id/:id/files",component:Y},{path:"search/:search/id/:id/files",component:Y},{path:"page/:page/id/:id/files",component:Y},{path:"search/:search/page/:page/id/:id/files",component:Y}]}]}}},6441:(e,t,i)=>{i.d(t,{Z:()=>l});i(4409);var s=i(4089);class a{constructor(e){const t=s.Z.pObject(e.Files),i=s.Z.pObject(e.CorporateFiles);this.enableUploadSizeLimit=s.Z.pBool(t.EnableUploadSizeLimit),this.uploadSizeLimitMb=s.Z.pNonNegativeInt(t.UploadSizeLimitMb),this.userSpaceLimitMb=s.Z.pNonNegativeInt(t.UserSpaceLimitMb),this.tenantSpaceLimitMb=s.Z.pNonNegativeInt(t.TenantSpaceLimitMb),this.showCorporateFilesAdminSection=!0,this.corporateSpaceLimitMb=s.Z.pNonNegativeInt(i.SpaceLimitMb)}saveFilesSettings({enableUploadSizeLimit:e,uploadSizeLimitMb:t,userSpaceLimitMb:i}){this.enableUploadSizeLimit=e,this.uploadSizeLimitMb=t,this.userSpaceLimitMb=i}savePersonalFilesSettings({tenantSpaceLimitMb:e,userSpaceLimitMb:t}){this.tenantSpaceLimitMb=e,this.userSpaceLimitMb=t}saveCorporateFilesSettings({spaceLimitMb:e}){this.corporateSpaceLimitMb=e}}let n=null;const l={init(e){n=new a(e)},getFilesSettings(){return{enableUploadSizeLimit:n.enableUploadSizeLimit,uploadSizeLimitMb:n.uploadSizeLimitMb,tenantSpaceLimitMb:n.tenantSpaceLimitMb,userSpaceLimitMb:n.userSpaceLimitMb,corporateSpaceLimitMb:n.corporateSpaceLimitMb}},saveFilesSettings(e){n.saveFilesSettings(e)},savePersonalFilesSettings(e){n.savePersonalFilesSettings(e)},saveCorporateFilesSettings(e){n.saveCorporateFilesSettings(e)}}}}]);