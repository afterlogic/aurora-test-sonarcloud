"use strict";(self.webpackChunkafterlogic_aurora_platform=self.webpackChunkafterlogic_aurora_platform||[]).push([[4250],{TWWV:(t,e,o)=>{var s=o("a7T2"),i=o("KC/L");t.exports={ServerModuleName:"MailSignup",HashModuleName:"signup",CustomLogoUrl:"",InfoText:"",BottomInfoHtmlText:"",DomainList:[],init:function(t){var e=t.MailSignup;if(!s.isEmpty(e)){var o=i.pArray(e.DomainList,this.DomainList);this.ServerModuleName=i.pString(e.ServerModuleName,this.ServerModuleName),this.HashModuleName=i.pString(e.HashModuleName,this.HashModuleName),this.CustomLogoUrl=i.pString(e.CustomLogoUrl,this.CustomLogoUrl),this.InfoText=i.pString(e.InfoText,this.InfoText),this.BottomInfoHtmlText=i.pString(e.BottomInfoHtmlText,this.BottomInfoHtmlText),this.DomainList=i.isNonEmptyArray(o)?o:["no domain set"]}}}},jxxk:(t,e,o)=>{t.exports=function(t){var e=o("9kOp"),s=o("TWWV"),i=e.getUserRole()===Enums.UserRole.Anonymous;return s.init(t),!e.isPublic()&&i?e.isMobile()?{getSignupScreenView:function(){return o("OcpQ")},getHashModuleName:function(){return s.HashModuleName}}:{getScreens:function(){var t={};return t[s.HashModuleName]=function(){return o("OcpQ")},t}}:null}},OcpQ:(t,e,o)=>{var s=o("a7T2"),i=o("M4cL"),n=o("p09A"),r=o("H20a"),a=o("Tt1R"),l=o("REt5"),u=o("EFhx"),h=o("/QeJ"),m=o("9kOp"),p=o("dfnr"),c=o("doeu"),d=o("skxT"),g=o("TWWV"),b=i("html");function f(){c.call(this,"MailSignup"),this.sCustomLogoUrl=g.CustomLogoUrl,this.sInfoText=g.InfoText,this.sBottomInfoHtmlText=g.BottomInfoHtmlText,this.aDomainList=n.observableArray(g.DomainList),this.sSelectedDomain=n.observable(""),this.name=n.observable(""),this.enableNameEdit=n.observable(!0),this.login=n.observable(""),this.enableLoginEdit=n.observable(!0),this.password=n.observable(""),this.confirmPassword=n.observable(""),this.nameFocus=n.observable(!1),this.loginFocus=n.observable(!1),this.passwordFocus=n.observable(!1),this.confirmPasswordFocus=n.observable(!1),this.loading=n.observable(!1),this.canTrySignup=n.computed((function(){return!this.loading()}),this),this.signupButtonText=n.computed((function(){return this.loading()?r.i18n("MAILSIGNUP/ACTION_SIGNUP_IN_PROGRESS"):r.i18n("MAILSIGNUP/ACTION_SIGNUP")}),this),this.signupCommand=l.createCommand(this,this.signup,this.canTrySignup),this.shake=n.observable(!1).extend({autoResetToFalse:800}),this.beforeButtonsControllers=n.observableArray([]),m.broadcastEvent("AnonymousUserForm::PopulateBeforeButtonsControllers",{ModuleName:"MailSignup",RegisterBeforeButtonsController:this.registerBeforeButtonsController.bind(this)}),this.welcomeText=n.observable(""),m.subscribeEvent("ShowWelcomeSignupText",s.bind((function(t){this.welcomeText(t.WelcomeText),this.login(t.UserName),this.enableLoginEdit(!1)}),this)),m.broadcastEvent("MailSignup::ConstructView::after",{Name:this.ViewConstructorName,View:this})}s.extendOwn(f.prototype,c.prototype),f.prototype.ViewTemplate="MailSignup_MainView",f.prototype.ViewConstructorName="CMainView",f.prototype.onBind=function(){b.addClass("non-adjustable-valign")},f.prototype.onShow=function(){s.delay(s.bind((function(){""===this.login()&&this.loginFocus(!0)}),this),1)},f.prototype.validateForm=function(t,e,o){return""===t?(this.loginFocus(!0),this.shake(!0),!1):""===e?(this.passwordFocus(!0),this.shake(!0),!1):""===e||e===o||(this.confirmPasswordFocus(!0),this.shake(!0),d.showError(r.i18n("COREWEBCLIENT/ERROR_PASSWORDS_DO_NOT_MATCH")),!1)},f.prototype.signup=function(){if(!this.loading()){var t=i.trim(this.name()),e=i.trim(this.login())+"@"+this.sSelectedDomain(),o=i.trim(this.password()),s=i.trim(this.confirmPassword()),n={Name:t,Login:e,Password:o};m.broadcastEvent("AnonymousUserForm::PopulateFormSubmitParameters",{Module:"MailSignup",Parameters:n}),this.validateForm(e,o,s)&&(this.loading(!0),u.send("MailSignup","Signup",n,this.onSignupResponse,this))}},f.prototype.onSignupResponse=function(t,e){!1===t.Result?(this.loading(!1),this.shake(!0),h.showErrorByCode(t,r.i18n("MAILSIGNUP/ERROR_SIGNUP_FAILED"))):(m.setAuthToken(t.Result.AuthToken),""!==window.location.search&&null===a.getRequestParam("reset-pass")&&null===a.getRequestParam("invite-auth")&&null===a.getRequestParam("oauth")?a.clearAndReloadLocation(p.ie8AndBelow,!0):a.clearAndReloadLocation(p.ie8AndBelow,!1))},f.prototype.registerBeforeButtonsController=function(t){this.beforeButtonsControllers.push(t)},t.exports=new f}}]);