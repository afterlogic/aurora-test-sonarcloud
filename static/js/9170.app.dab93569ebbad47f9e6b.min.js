(self.webpackChunkafterlogic_aurora_platform=self.webpackChunkafterlogic_aurora_platform||[]).push([[9170],{vdUg:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("KC/L"),a=s("REt5"),l=s("9kOp"),h=s("dfnr"),c=s("oUN1");function u(e,t,s,a,h,c,u,d,p,m,g){this.active=r.observable(!1),this.fSelectCallback=t||function(){},this.fDeleteCallback=s||function(){},this.fDblClickCallback=!l.isMobile()&&a?a:function(){},this.fEnterCallback=h||function(){},this.bResetCheckedOnClick=!!u,this.bCheckOnSelect=!!d,this.bUnselectOnCtrl=!!p,this.bDisableMultiplySelection=!!m,this.bChangeOnSelect=void 0===g||!!g,this.useKeyboardKeys=r.observable(!1),this.list=r.observableArray([]),e&&e.subscribe&&e.subscribe((function(e){this.list(e)}),this),this.multiplyLineFactor=c,this.oLast=null,this.oListScope=null,this.oScrollScope=null,this.iTimer=0,this.iFactor=1,this.KeyUp=Enums.Key.Up,this.KeyDown=Enums.Key.Down,this.KeyLeft=Enums.Key.Up,this.KeyRight=Enums.Key.Down,this.multiplyLineFactor&&(this.multiplyLineFactor.subscribe?this.multiplyLineFactor.subscribe((function(e){this.iFactor=0<e?e:1}),this):this.iFactor=n.pInt(this.multiplyLineFactor),this.KeyUp=Enums.Key.Up,this.KeyDown=Enums.Key.Down,this.KeyLeft=Enums.Key.Left,this.KeyRight=Enums.Key.Right,o("html").hasClass("rtl")&&(this.KeyLeft=Enums.Key.Right,this.KeyRight=Enums.Key.Left)),this.sActionSelector="",this.sSelectableSelector="",this.sCheckboxSelector="";var b=this;this.listChecked=r.computed({read:function(){return i.filter(this.list(),(function(e){var t=e&&e.checked&&e.checked(),s=e&&e.selected&&e.selected();return t||b.bCheckOnSelect&&s}))},write:function(e){e=!!e,i.each(this.list(),(function(t){t.checked(e)})),this.list.valueHasMutated()},owner:this}),this.checkAll=r.computed({read:function(){return 0<this.listChecked().length},write:function(e){this.listChecked(!!e)},owner:this}),this.selectorHook=r.observable(null),this.selectorHook.subscribe((function(){this.active()&&this.selectorHook()&&this.selectorHook().selected(!1)}),this,"beforeChange"),this.selectorHook.subscribe((function(){this.active()&&this.selectorHook()&&this.selectorHook().selected(!0)}),this),this.itemSelected=r.computed({read:this.selectorHook,write:function(e){this.selectorHook(e),e&&(b.scrollToSelected(),this.oLast=e)},owner:this}),this.list.subscribe((function(e){const t=this.itemSelected();Array.isArray(e)&&t&&e.find((e=>"function"==typeof t.isEqual?t.isEqual(e):t===e))||this.itemSelected(null)}),this),this.listCheckedOrSelected=r.computed({read:function(){var e=this.itemSelected(),t=this.listChecked();return 0<t.length?t:e?[e]:[]},write:function(e){e?this.listChecked(!0):(this.itemSelected(null),this.listChecked(!1))},owner:this}),this.listCheckedAndSelected=r.computed({read:function(){var e=[],t=this.itemSelected(),s=this.listChecked();return s&&(e=s.slice(0)),t&&-1===i.indexOf(s,t)&&e.push(t),e},write:function(e){e?this.listChecked(!0):(this.itemSelected(null),this.listChecked(!1))},owner:this}),this.isIncompleteChecked=r.computed((function(){var e=this.list().length,t=this.listChecked().length;return 0<e&&0<t&&e>t}),this),this.onKeydownBound=i.bind(this.onKeydown,this)}u.prototype.iTimer=0,u.prototype.bResetCheckedOnClick=!1,u.prototype.bCheckOnSelect=!1,u.prototype.bUnselectOnCtrl=!1,u.prototype.bDisableMultiplySelection=!1,u.prototype.getLastOrSelected=function(){var e=0,t=null;return i.each(this.list(),(function(s){s&&i.isFunction(s.checked)&&(s.checked()&&e++,s.selected()&&(t=s))})),0===e&&t?t:this.oLast},u.prototype.unbind=function(){this.active(!1),this.itemSelected()&&this.itemSelected().selected(!1),o(document).off("keydown",this.onKeydownBound),o(this.oListScope).off()},u.prototype.initOnApplyBindings=function(e,t,s,i,n){this.active(!0),o(document).on("keydown",this.onKeydownBound),this.oListScope=i,this.oScrollScope=n,this.sActionSelector=e,this.sSelectableSelector=t,this.sCheckboxSelector=s;var a=this,l=function(e,t,s){var i=0,o=0,r=null,n=!1,l=!1,h=[],c=!1;if(t=t||null,s&&s.shiftKey&&null!==t&&null!==e&&t!==e)for(h=a.list(),c=t.checked(),i=0,o=h.length;i<o;i++)n=!1,(r=h[i])!==e&&r!==t||(n=!0),n&&(l=!l),(l||n)&&r&&r.checked&&r.checked(c);t&&(a.oLast=t)};o(this.oListScope).on("dblclick",e,(function(e){var t=r.dataFor(this);!t||!e||e.ctrlKey||e.altKey||e.shiftKey||a.onDblClick(t)})),h.mobileDevice&&o(this.oListScope).on("touchstart",e,(function(e){if(e){var t=e.timeStamp,s=t-(o(this).data("lastTouch")||t),i=e.originalEvent&&e.originalEvent.touches?e.originalEvent.touches.length:0;o(this).data("lastTouch",t),!s||s>250||i>1||(e.preventDefault(),o(this).trigger("dblclick"))}})),o(this.oListScope).on("click",e,(function(e){var t=!0,s=null,i=a.getLastOrSelected(),o=r.dataFor(this);o&&e&&(e.shiftKey?(t=!1,a.bDisableMultiplySelection||(null===a.oLast&&(a.oLast=o),o.checked(!o.checked()),l(i,o,e))):(e.ctrlKey||e.metaKey)&&(t=!1,a.bDisableMultiplySelection||(a.oLast=o,!(s=a.itemSelected())||s.checked()||o.checked()||s.checked(!0),a.bUnselectOnCtrl&&o===a.itemSelected()?(o.checked(!o.selected()),a.itemSelected(null)):o.checked(!o.checked()))),t&&a.selectionFunc(o))})),o(this.oListScope).on("click",s,(function(e){var t=r.dataFor(this);t&&e&&!a.bDisableMultiplySelection&&(e.shiftKey?(null===a.oLast&&(a.oLast=t),l(a.getLastOrSelected(),t,e)):a.oLast=t),e&&e.stopPropagation&&e.stopPropagation()})),o(this.oListScope).on("dblclick",s,(function(e){e&&e.stopPropagation&&e.stopPropagation()}))},u.prototype.getResultSelection=function(e,t){var s=this,r=!1,n=!1,a=null,l=this.iFactor,h=!!this.multiplyLineFactor,c=0,u=0,d=[];if(!e&&-1<o.inArray(t,[this.KeyUp,this.KeyDown,this.KeyLeft,this.KeyRight,Enums.Key.PageUp,Enums.Key.PageDown,Enums.Key.Home,Enums.Key.End]))(d=this.list())&&0<d.length&&(-1<o.inArray(t,[this.KeyDown,this.KeyRight,Enums.Key.PageUp,Enums.Key.Home])?a=d[0]:-1<o.inArray(t,[this.KeyUp,this.KeyLeft,Enums.Key.PageDown,Enums.Key.End])&&(a=d[d.length-1]));else if(e&&0<(u=(d=this.list())?d.length:0))if(Enums.Key.Home===t||Enums.Key.PageUp===t||Enums.Key.End===t||Enums.Key.PageDown===t||h&&(Enums.Key.Left===t||Enums.Key.Right===t)||!h&&(Enums.Key.Up===t||Enums.Key.Down===t))i.each(d,(function(i){if(!r)switch(t){case s.KeyUp:case s.KeyLeft:e===i?r=!0:a=i;break;case Enums.Key.Home:case Enums.Key.PageUp:a=i,r=!0;break;case s.KeyDown:case s.KeyRight:n?(a=i,r=!0):e===i&&(n=!0);break;case Enums.Key.End:case Enums.Key.PageDown:a=i}}));else if(h&&this.KeyDown===t){for(;c<u;c++)if(e===d[c]){u-1<(c+=l)&&(c-=l),a=d[c];break}}else if(h&&this.KeyUp===t)for(c=u;c>=0;c--)if(e===d[c]){0>(c-=l)&&(c+=l),a=d[c];break}return a},u.prototype.shiftClickResult=function(e,t,s){if(t){var r=!!this.multiplyLineFactor,n=!1,a=!1;-1<o.inArray(s,r?[Enums.Key.Left,Enums.Key.Right]:[Enums.Key.Up,Enums.Key.Down])?t.checked(!t.checked()):-1<o.inArray(s,r?[Enums.Key.Up,Enums.Key.Down,Enums.Key.PageUp,Enums.Key.PageDown,Enums.Key.Home,Enums.Key.End]:[Enums.Key.Left,Enums.Key.Right,Enums.Key.PageUp,Enums.Key.PageDown,Enums.Key.Home,Enums.Key.End])&&(a=!t.checked(),i.each(this.list(),(function(s){var i=!1;s!==e&&t!==s||(n=!n,i=!0),(n||i)&&(s.checked(a),i=!1)})),r&&e&&(s===Enums.Key.Up||s===Enums.Key.Down)&&e.checked(!e.checked()))}},u.prototype.clickNewSelectPosition=function(e,t){var s=this.itemSelected(),i=this.getResultSelection(s,e);i&&(t&&this.shiftClickResult(i,s,e),this.selectionFunc(i))},u.prototype.onKeydown=function(e){var t=!0,s=0;return this.useKeyboardKeys()&&e&&!a.isTextFieldFocused()&&!c.hasOpenedMaximizedPopups()&&(s=e.keyCode,e.ctrlKey||this.KeyUp!==s&&this.KeyDown!==s&&this.KeyLeft!==s&&this.KeyRight!==s&&Enums.Key.PageUp!==s&&Enums.Key.PageDown!==s&&Enums.Key.Home!==s&&Enums.Key.End!==s?Enums.Key.Del!==s||e.ctrlKey||e.shiftKey?Enums.Key.Enter===s?0<this.list().length&&!e.ctrlKey&&(this.onEnter(this.itemSelected()),t=!1):!e.ctrlKey||e.altKey||e.shiftKey||Enums.Key.a!==s||(this.checkAll(!(this.checkAll()&&!this.isIncompleteChecked())),t=!1):0<this.list().length&&(this.onDelete(),t=!1):(this.clickNewSelectPosition(s,e.shiftKey),t=!1)),t},u.prototype.onDelete=function(){this.fDeleteCallback.call(this,this.listCheckedOrSelected())},u.prototype.onEnter=function(e){e&&this.fEnterCallback.call(this,e)},u.prototype.selectionFunc=function(e){this.bChangeOnSelect&&this.itemSelected(null),this.bResetCheckedOnClick&&this.listChecked(!1),this.bChangeOnSelect&&this.itemSelected(e),this.fSelectCallback.call(this,e)},u.prototype.onDblClick=function(e){this.fDblClickCallback.call(this,e)},u.prototype.koCheckAll=function(){return r.computed({read:this.checkAll,write:this.checkAll,owner:this})},u.prototype.koCheckAllIncomplete=function(){return r.computed({read:this.isIncompleteChecked,write:this.isIncompleteChecked,owner:this})},u.prototype.scrollToSelected=function(){if(!(this.oListScope&&this.oScrollScope&&this.oScrollScope[0]&&this.oScrollScope[0].isConnected))return!1;var e=o(this.sSelectableSelector,this.oScrollScope),t=e[0]?e[0].offsetTop:void 0,s=this.oScrollScope.height(),i=this.oScrollScope.scrollTop(),r=e.outerHeight();return!(t&&t>=i&&t<=i+s-r||(t<i+s&&t+r>i+s?this.oScrollScope.scrollTop(t+r+20-s):this.oScrollScope.scrollTop(t-20),0))},e.exports=u},A3in:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("sdEb"),r={getTimeListStepHour:function(e,t){return e=e||"HH:mm",t=t||"k",i.map(["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],(function(s){var i=o(s,"HH:mm");return{text:i.format(e),value:i.format(t)}}))},getTimeListStepHalfHour:function(e){return i.map(["00:00","00:30","01:00","01:30","02:00","02:30","03:00","03:30","04:00","04:30","05:00","05:30","06:00","06:30","07:00","07:30","08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30"],(function(t){var s=o(t,"HH:mm").format(e);return{text:s,value:s}}))},getDateFormatForDatePicker:function(e){return e.replace("MM","mm").replace("DD","dd").replace("YYYY","yy").replace("Month","MM")}};e.exports=r},injE:(e,t,s)=>{"use strict";var i=s("H20a"),o={getMonthNamesArray:function(){for(var e=i.i18n("COREWEBCLIENT/LIST_MONTH_NAMES").split(" "),t=e.length;t<12;t++)e[t]="";return e},daysInMonth:function(e,t){return 0<e&&13>e&&0<t?new Date(t,e,0).getDate():31}};e.exports=o},C5H3:(e,t,s)=>{var i=s("p09A"),o=s("W66n");function r(e){this.sName="",this.visible=i.observable(!0),this.baseHash=i.observable(""),this.hash=i.observable(""),this.linkText=i.observable(e),this.isCurrent=i.observable(!1),this.recivedAnim=i.observable(!1).extend({autoResetToFalse:500}),this.unseenCount=i.observable(0),this.allowChangeTitle=i.observable(!1),this.inactiveTitle=i.observable(""),this.excludedHashes=i.observableArray([])}r.prototype.ViewTemplate="CoreWebclient_HeaderItemView",r.prototype.setName=function(e){this.sName=e.toLowerCase(),""===this.baseHash()?(this.hash(o.buildHashFromArray([e.toLowerCase()])),this.baseHash(this.hash())):this.hash(this.baseHash())},e.exports=r},yKBN:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("REt5"),a=s("9kOp");function l(e,t){this.bShown=!1,this.currentPage=r.observable(1),this.count=r.observable(e),this.perPage=r.observable(t),this.firstPage=r.observable(1),this.lastPage=r.observable(1),this.pagesCount=r.computed((function(){var e=this.perPage()>0?Math.ceil(this.count()/this.perPage()):0;return e>0?e:1}),this),r.computed((function(){var e=20,t=4,s=this.pagesCount(),i=this.currentPage(),o=i,r=i;if(s>1)for(;e--,1<o&&(o--,t--),0!==t&&(s>r&&(r++,t--),0!==t)&&0!==e;);this.firstPage(o),this.lastPage(r)}),this),this.visibleFirst=r.computed((function(){return this.firstPage()>1}),this),this.visibleLast=r.computed((function(){return this.lastPage()<this.pagesCount()}),this),this.clickPage=i.bind(this.clickPage,this),this.pages=r.computed((function(){var e=this.firstPage(),t=[];if(this.firstPage()<this.lastPage())for(;e<=this.lastPage();e++)t.push({number:e,current:e===this.currentPage(),clickFunc:this.clickPage});return t}),this),a.isMobile()||this.hotKeysBind()}l.prototype.ViewTemplate="CoreWebclient_PageSwitcherView",l.prototype.hotKeysBind=function(){o(document).on("keydown",o.proxy((function(e){if(this.bShown&&!n.isTextFieldFocused()){var t=e.keyCode;e.ctrlKey&&t===Enums.Key.Left?this.clickPreviousPage():e.ctrlKey&&t===Enums.Key.Right&&this.clickNextPage()}}),this))},l.prototype.hide=function(){this.bShown=!1},l.prototype.show=function(){this.bShown=!0},l.prototype.clear=function(){this.currentPage(1),this.count(0)},l.prototype.setCount=function(e){this.count(e),this.currentPage()>this.pagesCount()&&this.currentPage(this.pagesCount())},l.prototype.setPage=function(e,t){this.perPage(t),e>this.pagesCount()?this.currentPage(this.pagesCount()):this.currentPage(e)},l.prototype.clickPage=function(e){var t=e.number;t<1&&(t=1),t>this.pagesCount()&&(t=this.pagesCount()),this.currentPage(t)},l.prototype.clickFirstPage=function(){this.currentPage(1)},l.prototype.clickPreviousPage=function(){var e=this.currentPage()-1;e<1&&(e=1),this.currentPage(e)},l.prototype.clickNextPage=function(){var e=this.currentPage()+1;e>this.pagesCount()&&(e=this.pagesCount()),this.currentPage(e)},l.prototype.clickLastPage=function(){this.currentPage(this.pagesCount())},e.exports=l},"T+dd":(e,t,s)=>{"use strict";var i=s("a7T2");void 0===window.Enums&&(window.Enums={}),i.extendOwn(window.Enums,{FolderFilter:{Flagged:"flagged",Unseen:"unseen"},FolderTypes:{Inbox:1,Sent:2,Drafts:3,Spam:4,Trash:5,Virus:6,Starred:7,Template:8,System:9,User:10,AllInboxes:11},SearchFoldersMode:{Current:"",Sub:"sub",All:"all"},Importance:{Low:5,Normal:3,High:1},Sensitivity:{Nothing:0,Confidential:1,Private:2,Personal:3},AnotherMessageComposedAnswer:{Discard:"Discard",SaveAsDraft:"SaveAsDraft",Cancel:"Cancel"},ReplyType:{Reply:"reply",ReplyAll:"reply-all",Resend:"resend",Forward:"forward",ForwardAsAttach:"eml"},UseSignature:{Off:"0",On:"1"},MailErrors:{CannotMoveMessageQuota:4008},ServerOwnerType:{Account:"account",Tenant:"tenant",SuperAdmin:"superadmin"},StarredMessagesSource:{InboxOnly:"inbox_only",AllFolders:"all_folders"}})},UJpV:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("TdEd").run("MailWebclient","getComposeMessageToAddresses");i.isFunction(n)&&(r.bindingHandlers.makeLinkComposeMailTo={update:function(e,t,s,i,r){var a=o(e),l=t();a.show(),a.hasClass("button")||a.addClass("link"),a.click((function(){n(l)}))}}),r.bindingHandlers.moveToFolderFilter={init:function(e,t,s,r,n){var a=o(e),l=t(),h=o(e).find(l.container),c=i.isArray(l.options)?l.options:l.options(),u=l.value?l.value():"";i.find(c,(function(e){return e[l.optionsValue]===u}))||(u="",l.value("")),a.removeClass("expand"),h.empty(),i.each(c,(function(e){var t=o('<span class="item"></span>').text(e[l.optionsText]).data("value",e[l.optionsValue]);u===e[l.optionsValue]&&t.addClass("selected"),e.jq=t,h.append(t)})),h.on("click",".item",(function(){var e=o(this).data("value");l.value(e)})),a.click((function(){a.toggleClass("expand"),a.hasClass("expand")&&i.defer((function(){o(document).one("click",(function(){a.removeClass("expand")}))}))}))},update:function(e,t){var s=o(e),r=t(),n=i.isArray(r.options)?r.options:r.options(),a=r.value?r.value():"",l=i.find(n,(function(e){return e[r.optionsValue]===a})),h=s.find(".link");i.each(n,(function(e){e.jq&&e.jq.toggleClass("selected",a===e[r.optionsValue])})),l&&h.text(o.trim(l[r.optionsText]))}}},WBAn:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("p09A"),r=s("H20a"),n=s("REt5"),a=s("/QeJ"),l=s("o1lX"),h=s("7xgn"),c=s("QaEg"),u=s("F0Fd");function d(){l.call(this),this.isCreating=o.observable(!1),u.folderListLoading.subscribe((function(){-1===u.folderListLoading.indexOf(u.editedFolderList().iAccountId)&&this.isCreating()&&(i.isFunction(this.fCallback)&&this.fCallback(this.folderName(),this.parentFolder()),this.isCreating(!1),this.closePopup())}),this),this.options=o.observableArray([]),this.parentFolder=o.observable(""),this.folderName=o.observable(""),this.folderNameFocus=o.observable(!1),this.fCallback=null,this.defaultOptionsAfterRender=n.defaultOptionsAfterRender}i.extendOwn(d.prototype,l.prototype),d.prototype.PopupTemplate="MailWebclient_Settings_CreateFolderPopup",d.prototype.onOpen=function(e){this.options(u.editedFolderList().getOptions(r.i18n("MAILWEBCLIENT/LABEL_NO_PARENT_FOLDER"),!0,!1,!0)),this.fCallback=e,this.folderName(""),this.folderNameFocus(!0)},d.prototype.create=function(){var e=""===this.parentFolder()?u.editedFolderList().sNamespaceFolder:this.parentFolder(),t={AccountID:h.editedId(),FolderNameInUtf8:this.folderName(),FolderParentFullNameRaw:e,Delimiter:u.editedFolderList().sDelimiter};this.folderNameFocus(!1),this.isCreating(!0),c.send("CreateFolder",t,this.onCreateFolderResponse,this)},d.prototype.onCreateFolderResponse=function(e,t){e.Result?u.getFolderList(h.editedId()):(this.isCreating(!1),a.showErrorByCode(e,r.i18n("MAILWEBCLIENT/ERROR_CREATE_FOLDER")))},d.prototype.cancelPopup=function(){this.isCreating()||(i.isFunction(this.fCallback)&&this.fCallback("",""),this.closePopup())},e.exports=new d},"7+7L":(e,t,s)=>{"use strict";var i=s("REt5"),o=s("OfVV"),r=s("sdEb"),n={},a="YYYY.MM.DD";n.formattedDateSearchHighlightedInput=function(e){const t=i.getDateFormatForMoment(o.dateFormat()),s=e.match(/date:([^/]*)(\/([^/]*))?/);let n="",l="";if(s){const e=r(s[1],a);n=e.isValid()?e.format(t):s[1];const i=r(s[3],a);l=i.isValid()?i.format(t):s[3]}if(!n&&!l)return e;const h=e.match(/(\w+):(\S+)/g),c=[];return h&&h.forEach((e=>{const t=e.split(":"),s="date"===t[0]?n+" - "+l:t[1];c.push(t[0]+":"+s)})),c.join(" ")},n.changeDateStartAndDateEndformatForSend=function(e,t){const s=r(e?.trim(),i.getDateFormatForMoment(o.dateFormat())),n=r(t?.trim(),i.getDateFormatForMoment(o.dateFormat()));return[s.isValid()&&s.format(a)||"",n.isValid()&&n.format(a)||""]},e.exports=n},zwBT:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("p09A"),r=s("H20a"),n=s("9kOp"),a=s("TdEd"),l=s("W66n"),h=s("skxT"),c=s("OfVV"),u=s("oUN1"),d=s("WBAn"),p=s("7xgn"),m=s("F0Fd"),g=s("oFXy");function b(){this.folderList=m.folderList,this.folderFullName=o.computed((function(){var e=m.getCurrentFolder();return e?e.fullName():""}),this),this.unifiedInboxAllowed=p.unifiedInboxAllowed,this.oUnifiedInbox=m.oUnifiedInbox,this.manageFoldersHash=o.computed((function(){if(a.isModuleEnabled("SettingsWebclient")){var e=p.getCurrent();if(e&&e.allowManageFolders())return l.buildHashFromArray(["settings","mail-accounts","account",e.hash(),"folders"])}return"#"}),this),this.quotaProc=o.observable(-1),this.quotaDesc=o.observable(""),this.bShowQuotaBarTextAsTooltip=c.ShowQuotaBarTextAsTooltip,c.ShowQuotaBar&&o.computed((function(){m.quotaChangeTrigger();var e=p.getCurrent(),t=e?e.quota():0,s=e?e.usedSpace():0,i=0<t?Math.ceil(s/t*100):-1;return i=100<i?100:i,this.quotaProc(i),this.quotaDesc(-1<i?r.i18n("COREWEBCLIENT/INFO_QUOTA",{PROC:i,QUOTA:r.getFriendlySize(1024*t)}):""),c.QuotaWarningPerc>0&&-1!==i&&c.QuotaWarningPerc>100-i&&h.showError(r.i18n("COREWEBCLIENT/WARNING_QUOTA_ALMOST_REACHED"),!0),!0}),this),this.visibleNewFolderButton=o.computed((function(){return g.AllowAddNewFolderOnMainScreen&&this.folderList().collection().length>0}),this),this.underNewMessageButtonControllers=o.observableArray([]),this.underInboxFolderControllers=o.observableArray([]),this.folderListControllers=o.computed((function(){return this.underNewMessageButtonControllers().concat(this.underInboxFolderControllers())}),this),n.broadcastEvent("MailWebclient::RegisterFolderListController",i.bind((function(e,t){this.registerController(e,t)}),this))}b.prototype.ViewTemplate="MailWebclient_FoldersView",b.prototype.onShow=function(){this.folderListControllers().forEach((e=>{i.isFunction(e.onShow)&&e.onShow()}))},b.prototype.onRoute=function(e){this.folderListControllers().forEach((t=>{i.isFunction(t.onRoute)&&t.onRoute(e)}))},b.prototype.addNewFolder=function(){u.showPopup(d)},b.prototype.registerController=function(e,t){switch(t){case"UnderNewMessageButton":this.underNewMessageButtonControllers.push(e);break;case"UnderInboxFolder":this.underInboxFolderControllers.push(e)}},e.exports=b},fveu:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("H20a"),a=s("KC/L"),l=s("REt5"),h=s("9kOp"),c=s("W66n"),u=s("mGms"),d=s("doeu"),p=s("B5X4"),m=s("CPab"),g=s("7xgn"),b=s("F0Fd"),f=s("oFXy"),y=s("zwBT"),S=s("q9v7"),M=s("kb14");function C(){d.call(this,"MailWebclient"),h.broadcastEvent("MailWebclient::ConstructView::before",{Name:this.ViewConstructorName,View:this,MailCache:b}),this.browserTitle=r.computed((function(){return g.getEmail()+" - "+n.i18n("MAILWEBCLIENT/HEADING_BROWSER_TAB")})),this.folderList=b.folderList,this.domFoldersMoveTo=r.observable(null),this.openMessageInNewWindowBound=i.bind(this.openMessageInNewWindow,this),this.oFolderList=new y,this.isUnifiedFolderCurrent=b.oUnifiedInbox.selected,this.oBaseMessageList=new S(this.openMessageInNewWindowBound),this.messageList=r.observable(this.oBaseMessageList),this.isSearchMultiFolders=r.computed((function(){return this.messageList().searchFoldersMode()===Enums.SearchFoldersMode.Sub||this.messageList().searchFoldersMode()===Enums.SearchFoldersMode.All}),this),this.oBaseMessagePaneView=M,this.messagePane=r.observable(this.oBaseMessagePaneView),this.messagePane().openMessageInNewWindowBound=this.openMessageInNewWindowBound,this.messagePane.subscribe((function(){this.bindMessagePane(),this.messagePane().expandMessagePaneWidth=this.expandMessagePaneWidth}),this),this.expandListPaneWidth=r.observable(!1),this.expandMessagePaneWidth=r.observable(!1),this.messagePane().expandMessagePaneWidth=this.expandMessagePaneWidth,b.currentMessage.subscribe((function(){b.currentMessage()||this.expandMessagePaneWidth(!1)}),this),this.isEnableGroupOperations=r.computed((()=>this.messageList().isEnableGroupOperations())),this.sCustomBigButtonModule="",this.fCustomBigButtonHandler=null,this.customBigButtonText=r.observable(""),this.bigButtonCommand=l.createCommand(this,(function(){i.isFunction(this.fCustomBigButtonHandler)?this.fCustomBigButtonHandler():this.executeCompose()})),this.bigButtonText=r.computed((function(){return""!==this.customBigButtonText()?this.customBigButtonText():n.i18n("MAILWEBCLIENT/ACTION_NEW_MESSAGE")}),this),this.isTemplateFolder=r.computed((function(){return b.isTemplateFolder(b.getCurrentFolderFullname())}),this),this.checkMailCommand=l.createCommand(this,this.executeCheckMail),this.checkMailIndicator=r.observable(!0).extend({throttle:50}),r.computed((function(){this.checkMailIndicator(b.checkMailStarted()||b.messagesLoading())}),this),this.customModulesDisabledMark=r.observableArray([]),this.visibleMarkTool=r.computed((function(){return!this.isTemplateFolder()&&!a.isNonEmptyArray(this.customModulesDisabledMark())}),this),this.markAsReadCommand=l.createCommand(this.messageList(),(()=>{this.messageList().executeMarkAsRead()}),this.isEnableGroupOperations),this.markAsUnreadCommand=l.createCommand(this.messageList(),(()=>{this.messageList().executeMarkAsUnread()}),this.isEnableGroupOperations),this.markAllReadCommand=l.createCommand(this.messageList(),(()=>{this.messageList().executeMarkAllRead()})),this.customModulesDisabledMove=r.observableArray([]),this.visibleMoveTool=r.computed((function(){return!b.oUnifiedInbox.selected()&&!a.isNonEmptyArray(this.customModulesDisabledMove())}),this),this.needToCopyDraggedItems=r.observable(!1),this.moveToFolderTemplate="MailWebclient_Messages_MoveButtonView",this.moveToFolderCommand=l.createCommand(this,(function(){}),this.isEnableGroupOperations),this.deleteCommand=l.createCommand(this.messageList(),(()=>{this.messageList().executeDelete()}),this.isEnableGroupOperations),this.selectedCount=r.computed((function(){return this.messageList().checkedUids().length}),this),this.emptyTrashCommand=l.createCommand(b,b.executeEmptyTrash,(()=>this.messageList().isNotEmptyList())),this.emptySpamCommand=l.createCommand(b,b.executeEmptySpam,(()=>this.messageList().isNotEmptyList())),this.spamCommand=l.createCommand(this.messageList(),(()=>{this.messageList().executeSpam()}),this.isEnableGroupOperations),this.notSpamCommand=l.createCommand(this.messageList(),(()=>{this.messageList().executeNotSpam()}),this.isEnableGroupOperations),this.isSpamFolder=r.computed((function(){return b.getCurrentFolderType()===Enums.FolderTypes.Spam}),this),this.customModulesDisabledSpam=r.observableArray([]),this.allowedSpamAction=r.computed((function(){return f.AllowSpamFolder&&this.folderList().spamFolder()&&!this.isSpamFolder()&&!this.isTemplateFolder()&&!a.isNonEmptyArray(this.customModulesDisabledSpam())}),this),this.allowedNotSpamAction=r.computed((function(){return f.AllowSpamFolder&&this.isSpamFolder()&&!this.isTemplateFolder()}),this),this.isTrashFolder=r.computed((function(){return b.getCurrentFolderType()===Enums.FolderTypes.Trash}),this),f.HorizontalLayout&&o("html").addClass("layout-horiz-split"),h.subscribeEvent("CoreWebclient::GetDebugInfo",i.bind((function(e){e.Info.push("checkMailStarted: "+b.checkMailStarted()+", messagesLoading: "+b.messagesLoading())}),this)),h.broadcastEvent("MailWebclient::ConstructView::after",{Name:this.ViewConstructorName,View:this})}i.extendOwn(C.prototype,d.prototype),C.prototype.ViewTemplate=f.HorizontalLayout?"MailWebclient_MailHorizontalLayoutView":"MailWebclient_MailView",C.prototype.ViewConstructorName="CMailView",C.prototype.hasUnsavedChanges=function(){return this.messagePane()&&i.isFunction(this.messagePane().hasUnsavedChanges)&&this.messagePane().hasUnsavedChanges()},C.prototype.discardChanges=function(){this.messagePane()&&i.isFunction(this.messagePane().discardChanges)&&this.messagePane().discardChanges()},C.prototype.setCustomPreviewPane=function(e,t){this.messagePane().__customModuleName!==e&&(i.isFunction(this.messagePane().onHide)&&this.messagePane().onHide(),t.__customModuleName=e,this.messagePane(t),i.isFunction(this.messagePane().onShow)&&this.messagePane().onShow())},C.prototype.removeCustomPreviewPane=function(e){this.messagePane().__customModuleName===e&&(i.isFunction(this.messagePane().onHide)&&this.messagePane().onHide(),this.messagePane(this.oBaseMessagePaneView),i.isFunction(this.messagePane().onShow)&&this.messagePane().onShow())},C.prototype.setCustomMessageList=function(e,t){this.messageList().__customModuleName!==e&&(t.__customModuleName=e,this.changeMessageList(t))},C.prototype.removeCustomMessageList=function(e){this.messageList().__customModuleName===e&&this.changeMessageList(this.oBaseMessageList)},C.prototype.changeMessageList=function(e){i.isFunction(this.messageList().onHide)&&this.messageList().onHide(),i.isFunction(this.messageList().unbind)&&this.messageList().unbind(),this.messageList(e),i.isFunction(this.messageList().onBind)&&this.messageList().onBind(this.$viewDom),i.isFunction(this.messageList().onShow)&&this.messageList().onShow()},C.prototype.setCustomBigButton=function(e,t,s){this.sCustomBigButtonModule=e,this.fCustomBigButtonHandler=t,this.customBigButtonText(s)},C.prototype.removeCustomBigButton=function(e){this.sCustomBigButtonModule===e&&(this.sCustomBigButtonModule="",this.fCustomBigButtonHandler=null,this.customBigButtonText(""))},C.prototype.resetDisabledTools=function(e,t){-1!==o.inArray("spam",t)?this.customModulesDisabledSpam(i.union(this.customModulesDisabledSpam(),[e])):this.customModulesDisabledSpam(i.without(this.customModulesDisabledSpam(),e)),-1!==o.inArray("move",t)?this.customModulesDisabledMove(i.union(this.customModulesDisabledMove(),[e])):this.customModulesDisabledMove(i.without(this.customModulesDisabledMove(),e)),-1!==o.inArray("mark",t)?this.customModulesDisabledMark(i.union(this.customModulesDisabledMark(),[e])):this.customModulesDisabledMark(i.without(this.customModulesDisabledMark(),e))},C.prototype.executeCompose=function(){p.composeMessage()},C.prototype.executeCheckMail=function(){b.checkMessageFlags(),b.executeCheckMail(!0)},C.prototype.openMessageInNewWindow=function(e){if(e&&e.longUid){var t=e.accountId(),s=e.folder(),o=e.longUid(),r=this.folderList().getFolderByFullName(s),n=r?.type()===Enums.FolderTypes.Drafts,a="";this.isUnifiedFolderCurrent()&&(s=b.oUnifiedInbox.fullName(),n=!1),n?a=c.buildHashFromArray(m.getComposeFromMessage("drafts",t,s,o)):(a=c.buildHashFromArray(m.getViewMessage(t,s,o)),i.isFunction(this.messagePane().passReplyDataToNewTab)&&this.messagePane().passReplyDataToNewTab(e.longUid())),u.openTab("?message-newtab"+a)}},C.prototype.resizeDblClick=function(e,t){l.calmEvent(t),l.removeSelection(),this.expandListPaneWidth(!this.expandListPaneWidth())},C.prototype.onRoute=function(e){if(g.hasAccount()){var t=m.parseMailbox(e);g.changeCurrentAccountByHash(t.AccountHash),i.isFunction(this.oFolderList.onRoute)&&this.oFolderList.onRoute(e),this.messageList().onRoute(e),i.isFunction(this.messagePane().onRoute)&&this.messagePane().onRoute(e,t),t.MailtoCompose&&(h.isMobile()?(e=m.getComposeWithToField(e[2]),c.replaceHash(e),setTimeout((function(){c.clearPreviousHash()}),0)):(p.composeMessageToAddresses(e[2]),c.replaceHash(m.getMailbox())))}else c.replaceHash(["settings","mail-accounts","account","create"])},C.prototype.onShow=function(){i.isFunction(this.oFolderList.onShow)&&this.oFolderList.onShow(),this.messageList().onShow(),i.isFunction(this.messagePane().onShow)&&this.messagePane().onShow()},C.prototype.onHide=function(){this.messageList().onHide(),i.isFunction(this.messagePane().onHide)&&this.messagePane().onHide()},C.prototype.bindMessagePane=function(){i.isFunction(this.messagePane().onBind)&&(this.messagePane().onBind(this.$viewDom),this.messagePane().__bound=!0)},C.prototype.onBind=function(){var e=this.messageList();e.onBind(this.$viewDom),this.bindMessagePane(),o(this.domFoldersMoveTo()).on("click","span.folder",(function(t){var s=o(this).data("folder");b.getCurrentFolderFullname()!==s&&(t.ctrlKey?e.executeCopyToFolder(s):e.executeMoveToFolder(s))})),h.isMobile()||this.hotKeysBind()},C.prototype.hotKeysBind=function(){o(document).on("keydown",o.proxy((function(e){var t=e.keyCode,s=e&&!e.ctrlKey&&!e.altKey&&!e.shiftKey&&!l.isTextFieldFocused()&&this.shown(),i=this.messageList(),o=i.collection()[0],r=o&&b.currentMessage()&&o.longUid()===b.currentMessage().longUid();s&&t===Enums.Key.s||s&&r&&t===Enums.Key.Up?(e.preventDefault(),this.searchFocus()):i.isFocused()&&e&&t===Enums.Key.Down&&o?(e.preventDefault(),i.isFocused(!1),i.routeForMessage(o)):s&&t===Enums.Key.n&&(this.executeCompose(),e.preventDefault())}),this))},C.prototype.routeMessageView=function(e,t){c.setHash(m.getMailbox(e,this.messageList().oPageSwitcher.currentPage(),t))},C.prototype.dragAndDropHelper=function(e,t){e&&e.checked(!0);var s=l.draggableItems(),i=this.messageList().checkedOrSelectedUids(),r=i.length;return s.data("p7-message-list-folder",b.getCurrentFolderFullname()),s.data("p7-message-list-uids",i),this.needToCopyDraggedItems(t),o(".count-text",s).text(n.i18n("MAILWEBCLIENT/LABEL_DRAG_MESSAGES_PLURAL",{COUNT:t?"+ "+r:r},null,r)),s},C.prototype.messagesDrop=function(e,t,s){if(e){var i=s&&s.helper?s.helper:null,o=i?i.data("p7-message-list-folder"):"",r=i?i.data("p7-message-list-uids"):null;o&&r&&(l.uiDropHelperAnim(t,s),this.needToCopyDraggedItems()?this.messageList().executeCopyToFolder(e.fullName()):this.messageList().executeMoveToFolder(e.fullName()),this.uncheckMessages())}},C.prototype.searchFocus=function(){this.messageList().selector.useKeyboardKeys()&&!l.isTextFieldFocused()&&this.messageList().isFocused(!0)},C.prototype.onVolumerClick=function(e,t){t.stopPropagation()},C.prototype.uncheckMessages=function(){i.each(b.messages(),(function(e){e.checked(!1)}))},e.exports=C},q9v7:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("sdEb"),a=s("REt5"),l=s("injE"),h=s("H20a"),c=s("KC/L"),u=s("/QeJ"),d=s("9kOp"),p=s("dfnr"),m=s("qBBW"),g=s("vdUg"),b=s("TdEd"),f=s("W66n"),y=s("skxT"),S=s("OfVV"),M=s("jNBr"),C=s("yKBN"),E=s("B5X4"),F=s("CPab"),v=s("WOsA"),A=s("7+7L"),L=s("7xgn"),T=s("F0Fd"),w=s("oFXy"),I=s("A3in");function D(e){this.disableMoveMessages=r.computed((function(){var e=T.getCurrentFolder();return!e||e.disableMoveFrom()}),this),this.bVisibleSortByTool=w.MessagesSortBy.Allow&&w.MessagesSortBy.List.length>0,this.sSortBy=w.MessagesSortBy.DefaultSortBy,this.iSortOrder=w.MessagesSortBy.DefaultSortOrder,this.sortBy=r.observable(w.MessagesSortBy.DefaultSortBy),this.sortOrder=r.observable(w.MessagesSortBy.DefaultSortOrder),this.aSortList=[],i.each(w.MessagesSortBy.List,function(e){this.aSortList.push({sText:h.i18n("MAILWEBCLIENT/"+e.LangConst),sSortBy:e.SortBy})}.bind(this)),this.uploaderArea=r.observable(null),this.bDragActive=r.observable(!1),this.bDragActiveComp=r.computed((function(){return this.bDragActive()}),this),this.openMessageInNewWindowBound=e,this.isFocused=r.observable(!1),this.messagesContainer=r.observable(null),this.currentMessage=T.currentMessage,this.currentMessage.subscribe((function(){this.isFocused(!1),this.selector.itemSelected(this.currentMessage())}),this),this.folderList=T.folderList,this.folderList.subscribe((function(){setTimeout(this.onFolderListSubscribe.bind(this))}),this),this.folderFullName=r.observable(""),this.folderType=r.observable(Enums.FolderTypes.User),this.filters=r.observable(""),this.isStarredFolder=r.computed((()=>this.filters()===Enums.FolderFilter.Flagged)),this.isStarredInAllFolders=r.computed((()=>this.isStarredFolder()&&w.AllowChangeStarredMessagesSource&&w.StarredMessagesSource===Enums.StarredMessagesSource.AllFolders)),this.isStarredFolder.subscribe((()=>{this.isStarredFolder()&&this.selectedSearchFoldersMode(this.isStarredInAllFolders()?"all":"")})),this.allowAdvancedSearch=r.computed((function(){return!b.isModuleIncluded("MailNotesPlugin")||"Notes"!==this.folderFullName()}),this),this.searchHighlightedInputFormatted=r.observable(""),this.searchHighlightedInput=r.observable(""),this.searchHighlightedInput.subscribe((()=>{this.searchHighlightedInputFormatted(A.formattedDateSearchHighlightedInput(this.searchHighlightedInput()))})),this.searchInput=r.computed({read:()=>this.isStarredInAllFolders()?`${this.searchHighlightedInputFormatted()} folders:all`:this.searchHighlightedInputFormatted(),write:e=>{this.isStarredInAllFolders()?this.searchHighlightedInput(e.replace("folders:all","")):this.searchHighlightedInput(e)}}),this.searchInputFrom=r.observable(""),this.searchInputTo=r.observable(""),this.searchInputSubject=r.observable(""),this.searchInputText=r.observable(""),this.searchSpan=r.observable(""),this.highlightTrigger=r.observable(""),this.selectedSearchFoldersMode=r.observable(""),this.selectedSearchFoldersModeText=r.computed((function(){return this.selectedSearchFoldersMode()===Enums.SearchFoldersMode.Sub?h.i18n("MAILWEBCLIENT/LABEL_SEARCH_CURRENT_FOLDER_AND_SUBFOLDERS"):this.selectedSearchFoldersMode()===Enums.SearchFoldersMode.All?h.i18n("MAILWEBCLIENT/LABEL_SEARCH_ALL_FOLDERS"):h.i18n("MAILWEBCLIENT/LABEL_SEARCH_CURRENT_FOLDER")}),this),this.uidList=T.uidList,this.uidList.subscribe((function(){this.uidList().searchCountSubscription&&(this.uidList().searchCountSubscription.dispose(),this.uidList().searchCountSubscription=void 0),this.uidList().searchCountSubscription=this.uidList().resultCount.subscribe((function(){this.uidList().resultCount()>=0&&this.oPageSwitcher.setCount(this.uidList().resultCount())}),this),this.uidList().resultCount()>=0&&this.oPageSwitcher.setCount(this.uidList().resultCount())}),this),this.useThreading=r.computed((function(){var e=L.getCurrent(),t=T.getCurrentFolder(),s=t&&t.withoutThreads(),i=""===this.uidList().search()&&""===this.uidList().filters();return e&&e.threadingIsAvailable()&&!s&&i}),this),this.collection=T.messages,this._search=r.observable(""),this.search=r.computed({read:function(){return o.trim(this._search())},write:this._search,owner:this}),this.searchFoldersMode=r.observable(""),this.messageListParamsChanged=r.observable(!1).extend({autoResetToFalse:100}),this.isEmptyList=r.computed((function(){return 0===this.collection().length}),this),this.isNotEmptyList=r.computed((function(){return 0!==this.collection().length}),this),this.isSearch=r.computed((function(){return this.search().length>0}),this),this.isUnseenFilter=r.computed((function(){return this.filters()===Enums.FolderFilter.Unseen}),this),this.isLoading=T.messagesLoading,this.isError=T.messagesLoadingError,this.visibleInfoLoading=r.computed((function(){return!this.isSearch()&&this.isLoading()}),this),this.visibleInfoSearchLoading=r.computed((function(){return this.isSearch()&&this.isLoading()}),this),this.visibleInfoSearchList=r.computed((function(){return this.isSearch()&&!this.isUnseenFilter()&&!this.isLoading()&&!this.isEmptyList()}),this),this.visibleInfoMessageListEmpty=r.computed((function(){return!this.isLoading()&&!this.isSearch()&&""===this.filters()&&this.isEmptyList()&&!this.isError()}),this),this.visibleInfoStarredFolderEmpty=r.computed((function(){return!this.isLoading()&&!this.isSearch()&&this.isStarredFolder()&&this.isEmptyList()&&!this.isError()}),this),this.visibleInfoSearchEmpty=r.computed((function(){return this.isSearch()&&!this.isUnseenFilter()&&this.isEmptyList()&&!this.isError()&&!this.isLoading()}),this),this.visibleInfoMessageListError=r.computed((function(){return!this.isSearch()&&this.isError()}),this),this.visibleInfoSearchError=r.computed((function(){return this.isSearch()&&this.isError()}),this),this.visibleInfoUnseenFilterList=r.computed((function(){return this.isUnseenFilter()&&(this.isLoading()||!this.isEmptyList())}),this),this.visibleInfoUnseenFilterEmpty=r.computed((function(){return this.isUnseenFilter()&&this.isEmptyList()&&!this.isError()&&!this.isLoading()}),this),this.allowClearSearch=r.observable(!0),this.searchText=r.computed((function(){const e={SEARCH:this.calculateSearchStringForDescription(),FOLDER:T.getCurrentFolder()?h.encodeHtml(T.getCurrentFolder().displayName()):""};return this.allowClearSearch(!0),this.searchFoldersMode()===Enums.SearchFoldersMode.Sub?T.oUnifiedInbox.selected()?h.i18n("MAILWEBCLIENT/INFO_SEARCH_UNIFIED_SUBFOLDERS_RESULT",e):"folders:sub"===o.trim(this.search())?h.i18n("MAILWEBCLIENT/INFO_MESSAGES_FROM_SUBFOLDERS",e):h.i18n("MAILWEBCLIENT/INFO_SEARCH_SUBFOLDERS_RESULT",e):this.searchFoldersMode()===Enums.SearchFoldersMode.All?T.oUnifiedInbox.selected()?h.i18n("MAILWEBCLIENT/INFO_SEARCH_UNIFIED_ALL_FOLDERS_RESULT",e):"folders:all"===o.trim(this.search())?(this.isStarredFolder()&&this.allowClearSearch(!1),h.i18n("MAILWEBCLIENT/INFO_MESSAGES_FROM_ALL_FOLDERS",e)):h.i18n("MAILWEBCLIENT/INFO_SEARCH_ALL_FOLDERS_RESULT",e):h.i18n("MAILWEBCLIENT/INFO_SEARCH_RESULT",e)}),this),this.unseenFilterText=r.computed((function(){return""===this.search()?h.i18n("MAILWEBCLIENT/INFO_UNREAD_MESSAGES",{FOLDER:T.getCurrentFolder()?h.encodeHtml(T.getCurrentFolder().displayName()):""}):h.i18n("MAILWEBCLIENT/INFO_UNREAD_MESSAGES_SEARCH_RESULT",{SEARCH:this.calculateSearchStringForDescription(),FOLDER:T.getCurrentFolder()?h.encodeHtml(T.getCurrentFolder().displayName()):""})}),this),this.unseenFilterEmptyText=r.computed((function(){return""===this.search()?h.i18n("MAILWEBCLIENT/INFO_NO_UNREAD_MESSAGES"):h.i18n("MAILWEBCLIENT/INFO_NO_UNREAD_MESSAGES_FOUND")}),this),this.isEnableGroupOperations=r.observable(!1).extend({throttle:250}),this.selector=new g(this.collection,i.bind(this.routeForMessage,this),i.bind(this.onDeletePress,this),i.bind(this.onMessageDblClick,this),i.bind(this.onEnterPress,this),null,!1,!1,!1,!1,!1),this.checkedUids=r.computed((function(){var e=this.selector.listChecked(),t=i.map(e,(function(e){return e.longUid()})),s=T.getCurrentFolder(),o=s?s.getThreadCheckedUidsFromList(e):[];return i.union(t,o)}),this),this.checkedOrSelectedUids=r.computed((function(){var e=this.checkedUids();return 0===e.length&&T.currentMessage()&&i.isFunction(T.currentMessage().deleted)&&!T.currentMessage().deleted()&&(e=[T.currentMessage().longUid()]),e}),this),r.computed((function(){this.isEnableGroupOperations(0<this.selector.listCheckedOrSelected().length)}),this),this.checkAll=this.selector.koCheckAll(),this.checkAllIncomplite=this.selector.koCheckAllIncomplete(),this.pageSwitcherLocked=r.observable(!1),this.oPageSwitcher=new C(0,w.MailsPerPage),this.oPageSwitcher.currentPage.subscribe((function(e){var t=T.getCurrentFolderFullname(),s=!d.isMobile()&&this.currentMessage()?this.currentMessage().longUid():"",i=this.search();this.pageSwitcherLocked()||this.changeRoutingForMessageList(t,e,s,i,this.filters(),this.sortBy(),this.sortOrder())}),this),this.currentPage=r.observable(0),p.firefox||p.ie?this.listChangedThrottle=r.observable(!1).extend({throttle:10}):this.listChangedThrottle=r.observable(!1),this.firstCompleteCollection=r.observable(!0),this.collection.subscribe((function(){this.collection().length>0&&(c.isNonEmptyArray(this.aRouteParams)?(this.onRoute(this.aRouteParams),this.aRouteParams=[]):this.firstCompleteCollection(!1))}),this),this.listChanged=r.computed((function(){return[this.firstCompleteCollection(),T.currentAccountId(),this.folderFullName(),this.filters(),this.search(),this.oPageSwitcher.currentPage()]}),this),this.listChanged.subscribe((function(){this.listChangedThrottle(!this.listChangedThrottle())}),this),this.bAdvancedSearch=r.observable(!1),this.searchAttachmentsCheckbox=r.observable(!1),this.searchAttachments=r.observable(""),this.searchAttachments.subscribe((function(e){this.searchAttachmentsCheckbox(!!e)}),this),this.searchAttachmentsFocus=r.observable(!1),this.searchFromFocus=r.observable(!1),this.searchSubjectFocus=r.observable(!1),this.searchToFocus=r.observable(!1),this.searchTextFocus=r.observable(!1),this.searchTrigger=r.observable(null),this.searchDateStartFocus=r.observable(!1),this.searchDateEndFocus=r.observable(!1),this.searchDateStartDom=r.observable(null),this.searchDateStartTimestamp=r.observable(""),this.searchDateStart=r.observable(""),this.searchDateStart.subscribe((e=>{e&&this.searchDateStartTimestamp(n(e,a.getDateFormatForMoment(S.dateFormat())).toDate().getTime()/1e3)})),this.searchDateEndDom=r.observable(null),this.searchDateEndTimestamp=r.observable(""),this.searchDateEnd=r.observable(""),this.searchDateEnd.subscribe((e=>{e&&this.searchDateEndTimestamp(n(e,a.getDateFormatForMoment(S.dateFormat())).toDate().getTime()/1e3)})),this.dateFormatDatePicker=r.computed((()=>I.getDateFormatForDatePicker(S.dateFormat()))),S.dateFormat.subscribe((()=>{const e=new M,t=new M;this.searchDateStartTimestamp()&&(e.parse(this.searchDateStartTimestamp()),this.searchDateStart(e.getShortDate())),this.searchDateEndTimestamp()&&(t.parse(this.searchDateEndTimestamp()),this.searchDateEnd(t.getShortDate())),this.createDatePickerObject(this.searchDateStartDom(),this.searchDateStart),this.createDatePickerObject(this.searchDateEndDom(),this.searchDateEnd),this.searchHighlightedInputFormatted(A.formattedDateSearchHighlightedInput(this.searchHighlightedInput()))})),this.attachmentsPlaceholder=r.computed((function(){return h.i18n("MAILWEBCLIENT/LABEL_HAS_ATTACHMENTS")}),this),this.customMessageItemViewTemplate=r.observable(""),d.broadcastEvent("MailWebclient::ConstructView::after",{Name:this.ViewConstructorName,View:this,MailCache:T})}s("okSt"),D.prototype.ViewTemplate="MailWebclient_MessagesView",D.prototype.ViewConstructorName="CMessageListView",D.prototype.addNewAccount=function(){d.Api.createMailAccount(L.getEmail())},D.prototype.createDatePickerObject=function(e,t){o(e).datepicker("destroy"),o(e).datepicker({showOtherMonths:!0,selectOtherMonths:!0,monthNames:l.getMonthNamesArray(),dayNamesMin:h.i18n("COREWEBCLIENT/LIST_DAY_NAMES_MIN").split(" "),nextText:"",prevText:"",firstDay:c.pInt(b.run("CalendarWebclient","getWeekStartsOn")),showOn:"focus",dateFormat:this.dateFormatDatePicker(),onClose:function(e){r.isObservable(t)&&t(e)}}),o(e).mousedown((function(){o("#ui-datepicker-div").toggle()}))},D.prototype.changeRoutingForMessageList=function(e,t,s,i,o,r,n){f.setHash(F.getMailbox(e,t,s,i,o,r,n))&&i.length>0&&this.search()===i&&this.listChangedThrottle(!this.listChangedThrottle())},D.prototype.onEnterPress=function(e){e.threadNextLoadingVisible()?e.loadNextMessages():e.openThread()},D.prototype.onMessageDblClick=function(e){if(!this.isSavingDraft(e)){var t=this.folderList().getFolderByFullName(e.folder()),s={Message:e,Cancel:!1};d.broadcastEvent("MailWebclient::MessageDblClick::before",s),s.Cancel||(t.type()===Enums.FolderTypes.Drafts||T.isTemplateFolder(e.folder())?E.composeMessageFromDrafts(e.accountId(),e.folder(),e.longUid()):this.openMessageInNewWindowBound(e))}},D.prototype.onFolderListSubscribe=function(){this.setCurrentFolder(),this.requestMessageList()},D.prototype.onShow=function(e){this.selector.useKeyboardKeys(!0),this.oPageSwitcher.show(),this.oJua&&this.oJua.setDragAndDropEnabledStatus(!0)},D.prototype.onHide=function(e){this.selector.useKeyboardKeys(!1),this.oPageSwitcher.hide(),this.oJua&&this.oJua.setDragAndDropEnabledStatus(!1)},D.prototype.onRoute=function(e){var t=F.parseMailbox(e),s=this.folderFullName()||this.folderList().inboxFolderFullName(),i=function(e,t){if(e===Enums.FolderFilter.Flagged&&w.AllowChangeStarredMessagesSource)if(/(^|\s)folders:all(\s|$)/.test(t)){if(w.StarredMessagesSource===Enums.StarredMessagesSource.InboxOnly)return t.replace("folders:all","")}else if(w.StarredMessagesSource===Enums.StarredMessagesSource.AllFolders)return`${t} folders:all`;return t}(t.Filters,t.Search),o=this.currentPage()!==t.Page||s!==t.Folder||this.filters()!==t.Filters||t.Filters===Enums.FolderFilter.Unseen&&T.waitForUnseenMessages()||this.search()!==i||this.sSortBy!==t.SortBy||this.iSortOrder!==t.SortOrder,r=w.MailsPerPage!==this.oPageSwitcher.perPage();this.pageSwitcherLocked(!0),s!==t.Folder||this.search()!==i||this.filters()!==t.Filters?this.oPageSwitcher.clear():this.oPageSwitcher.setPage(t.Page,w.MailsPerPage),this.pageSwitcherLocked(!1),i!==t.Search?f.replaceHash(F.getMailbox(t.Folder,this.oPageSwitcher.currentPage(),t.Uid,i,t.Filters)):t.Page!==this.oPageSwitcher.currentPage()&&(0===this.folderList().iAccountId?this.aRouteParams=e:f.replaceHash(F.getMailbox(t.Folder,this.oPageSwitcher.currentPage(),t.Uid,i,t.Filters))),this.currentPage(this.oPageSwitcher.currentPage()),this.folderFullName(t.Folder),this.filters(t.Filters),this.search(i),this.searchInput(this.search()),this.setSearchFolderMode(),this.searchSpan.notifySubscribers(),this.sSortBy=t.SortBy,this.iSortOrder=t.SortOrder,this.sortBy(t.SortBy),this.sortOrder(t.SortOrder),this.setCurrentFolder(),(o||r||0===this.collection().length)&&(t.Filters===Enums.FolderFilter.Unseen&&T.waitForUnseenMessages(!0),this.requestMessageList(),this.messageListParamsChanged(!0)),this.highlightTrigger.notifySubscribers(!0)},D.prototype.setSearchFolderMode=function(){/(^|\s)folders:all(\s|$)/.test(this.search())?this.searchFoldersMode(Enums.SearchFoldersMode.All):/(^|\s)folders:sub(\s|$)/.test(this.search())?this.searchFoldersMode(Enums.SearchFoldersMode.Sub):this.searchFoldersMode(Enums.SearchFoldersMode.Current)},D.prototype.setCurrentFolder=function(){T.setCurrentFolder(this.folderFullName(),this.filters()),this.folderType(T.getCurrentFolderType())},D.prototype.requestMessageList=function(){var e=T.getCurrentFolderFullname(),t=this.oPageSwitcher.currentPage();e.length>0?T.changeCurrentMessageList(e,t,this.search(),this.filters(),this.sortBy(),this.sortOrder()):T.checkCurrentFolderList()},D.prototype.calculateSearchStringFromAdvancedForm=function(){var e=this.searchInputFrom(),t=this.searchInputTo(),s=this.searchInputSubject(),i=this.searchInputText(),r=this.searchAttachmentsCheckbox(),[n,a]=A.changeDateStartAndDateEndformatForSend(this.searchDateStart(),this.searchDateEnd()),l=[],h=function(e){return(-1<(e=o.trim(e).replace(/"/g,'\\"')).indexOf(" ")||-1<e.indexOf('"'))&&(e='"'+e+'"'),e};return""!==e&&l.push("from:"+h(e)),""!==t&&l.push("to:"+h(t)),""!==s&&l.push("subject:"+h(s)),""!==i&&l.push("text:"+h(i)),r&&l.push("has:attachments"),""===n&&""===a||l.push("date:"+h(n)+"/"+h(a)),this.selectedSearchFoldersMode()!==Enums.SearchFoldersMode.Sub&&this.selectedSearchFoldersMode()!==Enums.SearchFoldersMode.All||l.push("folders:"+this.selectedSearchFoldersMode()),l.join(" ")},D.prototype.manualChangeSearchString=function(e){const t=["date:","subject:","text:","from:","to:","has:","folders:"],s=new RegExp("\\s("+t.join("|")+")","g"),i=(" "+e).split(s);let o="";if(i.length>1)for(let e=1;e<i.length;e+=2){const s=i[e],r=i[e+1];if(s===t[0]){const[e,t]=r.split(" - "),[i,n]=A.changeDateStartAndDateEndformatForSend(e,t);(i||n)&&(o+=s+i+"/"+n+" ")}else o+=s+r+" "}else o=e;return o},D.prototype.onSearchClick=function(){var e=T.getCurrentFolderFullname(),t=this.searchInput();this.allowAdvancedSearch()&&this.bAdvancedSearch()?(t=this.calculateSearchStringFromAdvancedForm(),this.bAdvancedSearch(!1)):t=this.manualChangeSearchString(t),this.changeRoutingForMessageList(e,1,"",t,this.filters())},D.prototype.onRetryClick=function(){this.requestMessageList()},D.prototype.onClearSearchClick=function(){var e=T.getCurrentFolderFullname(),t=this.currentMessage()?this.currentMessage().longUid():"";this.clearAdvancedSearch(),this.changeRoutingForMessageList(e,1,t,"",this.filters(),this.sortBy(),this.sortOrder())},D.prototype.onClearFilterClick=function(){var e=T.getCurrentFolderFullname(),t=this.currentMessage()?this.currentMessage().longUid():"";this.clearAdvancedSearch(),this.changeRoutingForMessageList(e,1,t,"","",this.sortBy(),this.sortOrder())},D.prototype.onStopSearchClick=function(){this.onClearSearchClick()},D.prototype.isSavingDraft=function(e){return T.getCurrentFolder().type()===Enums.FolderTypes.Drafts&&e.longUid()===T.savingDraftUid()},D.prototype.routeForMessage=function(e){if(e&&e.longUid&&!this.isSavingDraft(e)){var t=T.getCurrentFolder(),s=T.getCurrentFolderFullname(),i=this.oPageSwitcher.currentPage(),o=e.longUid(),r=this.currentMessage()?this.currentMessage().longUid():"",n=this.search();""!==o&&o!==r&&(d.isMobile()&&t.type()===Enums.FolderTypes.Drafts?f.setHash(F.getComposeFromMessage("drafts",e.accountId(),e.folder(),e.longUid())):(this.changeRoutingForMessageList(s,i,o,n,this.filters(),this.sortBy(),this.sortOrder()),d.isMobile()&&T.currentMessage()&&o===T.currentMessage().longUid()&&T.currentMessage.valueHasMutated()))}},D.prototype.unbind=function(){this.selector.unbind()},D.prototype.onBind=function(e){var t=this,s=i.bind((function(e){e&&e.stopPropagation&&e.stopPropagation()}),this);o(".message_list",e).on("click",(function(){t.isFocused(!1)})).on("click",".message_sub_list .item .flag",(function(e){t.onFlagClick(r.dataFor(this)),e&&e.stopPropagation&&e.stopPropagation()})).on("dblclick",".message_sub_list .item .flag",s).on("click",".message_sub_list .item .thread-pin",s).on("dblclick",".message_sub_list .item .thread-pin",s),this.selector.initOnApplyBindings(".message_sub_list .item",".message_sub_list .item.selected",".message_sub_list .item .custom_checkbox",o(".message_list",e),o(".message_list_scroll.scroll-inner",e)),i.delay(i.bind((function(){this.createDatePickerObject(this.searchDateStartDom(),this.searchDateStart),this.createDatePickerObject(this.searchDateEndDom(),this.searchDateEnd)}),this),1e3),this.initUploader()},D.prototype.onFlagClick=function(e){this.isSavingDraft(e)||T.executeGroupOperation("SetMessageFlagged",[e.longUid()],"flagged",!e.flagged())},D.prototype.executeMarkAsRead=function(){T.executeGroupOperation("SetMessagesSeen",this.checkedOrSelectedUids(),"seen",!0)},D.prototype.executeMarkAsUnread=function(){T.executeGroupOperation("SetMessagesSeen",this.checkedOrSelectedUids(),"seen",!1)},D.prototype.executeMarkAllRead=function(){T.executeGroupOperation("SetAllMessagesSeen",[],"seen",!0)},D.prototype.executeMoveToFolder=function(e){var t=T.getFolderByFullName(T.currentAccountId(),e),s=this.checkedOrSelectedUids(),o=T.getUidsSeparatedByFolders(s);t&&i.each(o,(function(e){if(T.currentAccountId()===e.iAccountId){var s=T.getFolderByFullName(T.currentAccountId(),e.sFolder);s&&T.moveMessagesToFolder(s,t,e.aUids)}}))},D.prototype.executeCopyToFolder=function(e){var t=T.getFolderByFullName(T.currentAccountId(),e),s=this.checkedOrSelectedUids(),o=T.getUidsSeparatedByFolders(s);t&&i.each(o,(function(e){if(T.currentAccountId()===e.iAccountId){var s=T.getFolderByFullName(T.currentAccountId(),e.sFolder);s&&T.copyMessagesToFolder(s,t,e.aUids)}}))},D.prototype.onDeletePress=function(e){var t=i.map(e,(function(e){return e.longUid()}));t.length>0&&this.deleteMessages(t)},D.prototype.executeDelete=function(){this.deleteMessages(this.checkedOrSelectedUids())},D.prototype.deleteMessages=function(e){var t="",s=null;T.uidList().filters()!==Enums.FolderFilter.Unseen&&1===e.length&&T.currentMessage()&&e[0]===T.currentMessage().longUid()&&""===(t=T.prevMessageUid())&&(t=T.nextMessageUid()),e.length>0&&v.deleteMessages(e,function(){""!==t&&(s=i.find(this.collection(),(function(e){return e&&i.isFunction(e.longUid)&&(e.longUid()===t||e.uid()===t)})))&&this.routeForMessage(s)}.bind(this))},D.prototype.executeSpam=function(){var e=this.checkedOrSelectedUids(),t=T.getUidsSeparatedByFolders(e);i.each(t,(function(e){var t=T.oFolderListItems[e.iAccountId],s=t?t.spamFolder():null,i=t?t.getFolderByFullName(e.sFolder):null;i&&s&&i.fullName()!==s.fullName()&&T.moveMessagesToFolder(i,s,e.aUids)}))},D.prototype.executeNotSpam=function(){var e=T.getCurrentFolder(),t=this.folderList().inboxFolder(),s=this.checkedOrSelectedUids(),o=T.getUidsSeparatedByFolders(s);t&&e&&e.fullName()!==t.fullName()&&i.each(o,(function(s){e.iAccountId===s.iAccountId&&e.fullName()===s.sFolder&&T.moveMessagesToFolder(e,t,s.aUids)}))},D.prototype.executeSort=function(e){const t=this.sortBy();this.sortBy(e),t===e?this.sortOrder(this.sortOrder()===Enums.SortOrder.Asc?Enums.SortOrder.Desc:Enums.SortOrder.Asc):this.sortOrder(w.MessagesSortBy.DefaultSortOrder);const s=T.getCurrentFolderFullname(),i=this.oPageSwitcher.currentPage();this.changeRoutingForMessageList(s,i,"",this.search(),this.filters(),this.sortBy(),this.sortOrder())},D.prototype.clearAdvancedSearch=function(){this.searchInputFrom(""),this.searchInputTo(""),this.searchInputSubject(""),this.searchInputText(""),this.bAdvancedSearch(!1),this.searchAttachmentsCheckbox(!1),this.searchAttachments(""),this.searchDateStart(""),this.searchDateEnd(""),this.selectedSearchFoldersMode(this.isStarredInAllFolders()?"all":"")},D.prototype.onAdvancedSearchClick=function(){this.bAdvancedSearch(!this.bAdvancedSearch())},D.prototype.calculateSearchStringForDescription=function(){return h.encodeHtml(this.searchHighlightedInputFormatted().replace(/(^|\s)folders:(all|sub)(\s|$)/,""))},D.prototype.initUploader=function(){var e=this;this.uploaderArea()&&(this.oJua=new m({action:"?/Api/",name:"jua-uploader",queueSize:2,dragAndDropElement:this.uploaderArea(),disableAjaxUpload:!1,disableFolderDragAndDrop:!1,disableDragAndDrop:!1,hidden:i.extendOwn({Module:w.ServerModuleName,Method:"UploadMessage",Parameters:function(){return JSON.stringify({AccountID:T.currentAccountId(),Folder:e.folderFullName()})}},d.getCommonRequestParameters())}),this.oJua.on("onDrop",i.bind(this.onFileDrop,this)).on("onComplete",i.bind(this.onFileUploadComplete,this)).on("onBodyDragEnter",i.bind(this.bDragActive,this,!0)).on("onBodyDragLeave",i.bind(this.bDragActive,this,!1)))},D.prototype.onFileDrop=function(e){e&&e.File&&e.File.type&&0===e.File.type.indexOf("message/")||y.showError(h.i18n("MAILWEBCLIENT/ERROR_FILE_NOT_EML"))},D.prototype.onFileUploadComplete=function(e,t,s){t&&s&&!s.ErrorCode?T.executeCheckMail(!0):u.showErrorByCode(s||{},h.i18n("COREWEBCLIENT/ERROR_UPLOAD_FILE"))},D.prototype.selectFolderSearch=function(e){this.selectedSearchFoldersMode(e)},e.exports=D},kb14:(e,t,s)=>{"use strict";const i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("H20a"),a=s("KC/L"),l=s("Tt1R"),h=s("REt5"),c=s("9kOp"),u=s("TdEd"),d=s("fDmo"),p=s("W66n"),m=s("HCAJ"),g=s("OfVV"),b=s("mGms"),f=s("doeu"),y=s("B5X4"),S=s("CPab"),M=s("WOsA"),C=s("F0/K"),E=s("7xgn"),F=s("QaEg"),v=s("F0Fd"),A=s("cL06"),L=s("ixCM"),T=s("oFXy"),w=s("TGY0"),I=c.isNewTab()&&window.opener&&window.opener.MainTabMailMethods;function D(){f.call(this,"MailWebclient"),this.bNewTab=c.isNewTab(),this.isLoading=r.observable(!1),this.bAllowSearchMessagesBySubject=T.AllowSearchMessagesBySubject,v.folderList.subscribe(this.onFolderListSubscribe,this),this.messages=v.messages,this.messages.subscribe(this.onMessagesSubscribe,this),this.currentMessage=v.currentMessage,this.currentMessage.subscribe(this.onCurrentMessageSubscribe,this),g.timeFormat.subscribe(this.onCurrentMessageSubscribe,this),g.dateFormat.subscribe(this.onCurrentMessageSubscribe,this),this.displayedMessageUid=r.observable(""),this.browserTitle=r.computed((function(){var e=this.currentMessage(),t=e?e.subject():"";return(t?t+" - ":"")+E.getEmail()+" - "+n.i18n("MAILWEBCLIENT/HEADING_MESSAGE_BROWSER_TAB")}),this),this.isCurrentMessage=r.computed((function(){return!!this.currentMessage()}),this),this.isCurrentMessageLoaded=r.computed((function(){return this.isCurrentMessage()&&!this.isLoading()}),this),this.visibleNoMessageSelectedText=r.computed((function(){return this.messages().length>0&&!this.isCurrentMessage()}),this),this.prevMessageUid=v.prevMessageUid,this.nextMessageUid=v.nextMessageUid,this.isEnablePrevMessage=r.computed((function(){return c.isNewTab()&&a.isNonEmptyString(this.prevMessageUid())}),this),this.isEnableNextMessage=r.computed((function(){return c.isNewTab()&&a.isNonEmptyString(this.nextMessageUid())}),this),this.isEnableDelete=this.isCurrentMessage,this.isEnableReply=this.isCurrentMessageLoaded,this.isEnableReplyAll=this.isCurrentMessageLoaded,this.isEnableResend=this.isCurrentMessageLoaded,this.isEnableForward=this.isCurrentMessageLoaded,this.isEnablePrint=this.isCurrentMessageLoaded,this.isEnableSave=function(){return this.isCurrentMessage()&&""!==this.currentMessage().sDownloadAsEmlUrl},this.deleteCommand=h.createCommand(this,this.executeDeleteMessage,this.isEnableDelete),this.prevMessageCommand=h.createCommand(this,this.executePrevMessage,this.isEnablePrevMessage),this.nextMessageCommand=h.createCommand(this,this.executeNextMessage,this.isEnableNextMessage),this.replyCommand=h.createCommand(this,this.executeReply,this.isEnableReply),this.replyAllCommand=h.createCommand(this,this.executeReplyAll,this.isEnableReplyAll),this.resendCommand=h.createCommand(this,this.executeResend,this.isEnableResend),this.forwardCommand=h.createCommand(this,this.executeForward,this.isEnableForward),this.printCommand=h.createCommand(this,this.executePrint,this.isEnablePrint),this.saveCommand=h.createCommand(this,this.executeSave,this.isEnableSave),this.forwardAsAttachment=h.createCommand(this,this.executeForwardAsAttachment,this.isCurrentMessageLoaded),this.messageToolbarControllers=r.observableArray([]),this.registerController(L,"OnMessageToolbar"),this.moreCommand=h.createCommand(this,null,this.isCurrentMessageLoaded),this.moreSectionCommands=r.observableArray([]),c.broadcastEvent("MailWebclient::AddMoreSectionCommand",i.bind((function(e){var t=i.extend({Text:"",CssClass:"",Handler:function(){},Visible:!0},e);t.Command=h.createCommand(this,t.Handler,this.isCurrentMessageLoaded),this.moreSectionCommands.push(t)}),this)),this.oUnsubscribeButtonView=s("nWzW"),this.visiblePicturesControl=r.observable(!1),this.visibleShowPicturesLink=r.observable(!1),this.visibleConfirmationControl=r.computed((function(){return this.currentMessage()&&""!==this.currentMessage().readingConfirmationAddressee()&&this.currentMessage()&&this.currentMessage().readingConfirmationAddressee()!==E.getEmail()}),this),this.isCurrentNotDraftOrSent=r.computed((function(){var e=v.getCurrentFolder();return e&&e.fullName().length>0&&e.type()!==Enums.FolderTypes.Drafts&&e.type()!==Enums.FolderTypes.Sent}),this),this.isCurrentSentFolder=r.computed((function(){var e=v.getCurrentFolder();return!!e&&e.fullName().length>0&&e.type()===Enums.FolderTypes.Sent}),this),this.isCurrentNotDraftFolder=r.computed((function(){var e=v.getCurrentFolder();return!!e&&e.fullName().length>0&&e.type()!==Enums.FolderTypes.Drafts}),this),this.isCurrentTemplateFolder=r.computed((function(){return v.isTemplateFolder(v.getCurrentFolderFullname())}),this),this.topControllers=r.observableArray(),this.bodyControllers=r.observableArray(),this.bottomControllers=r.observableArray(),this.controllers=r.computed((function(){return i.union(this.topControllers(),this.bodyControllers(),this.bottomControllers(),this.messageToolbarControllers())}),this),this.disableAllSendTools=r.computed((function(){var e=!1;return i.each(this.controllers(),(function(t){i.isFunction(t.disableAllSendTools)&&t.disableAllSendTools()&&(e=!0)})),e}),this),this.isVisibleReplyTool=r.computed((function(){return!this.disableAllSendTools()&&this.isCurrentNotDraftOrSent()&&!this.isCurrentTemplateFolder()}),this),this.isVisibleResendTool=r.computed((function(){return!this.disableAllSendTools()&&this.isCurrentSentFolder()&&!this.isCurrentTemplateFolder()}),this),this.isVisibleForwardTool=r.computed((function(){return!this.disableAllSendTools()&&this.isCurrentNotDraftFolder()&&!this.isCurrentTemplateFolder()}),this),this.accountId=r.observable(0),this.folder=r.observable(""),this.uid=r.observable(""),this.subject=r.observable(""),this.emptySubject=r.computed((function(){return""===o.trim(this.subject())}),this),this.subjectForDisplay=r.computed((function(){return this.emptySubject()?n.i18n("MAILWEBCLIENT/LABEL_NO_SUBJECT"):this.subject()}),this),this.importance=r.observable(Enums.Importance.Normal),this.oFromAddr=r.observable(null),this.from=r.observable(""),this.fromEmail=r.observable(""),this.fullFrom=r.observable(""),this.to=r.observable(""),this.aToAddr=r.observableArray([]),this.cc=r.observable(""),this.aCcAddr=r.observableArray([]),this.bcc=r.observable(""),this.aBccAddr=r.observableArray([]),this.allRecipients=r.observableArray([]),this.currentAccountEmail=r.observable(),this.sMeSender=T.UseMeRecipientForMessages?n.i18n("MAILWEBCLIENT/LABEL_ME_SENDER"):null,this.sMeRecipient=T.UseMeRecipientForMessages?n.i18n("MAILWEBCLIENT/LABEL_ME_RECIPIENT"):null,this.fullDate=r.observable(""),this.midDate=r.observable(""),this.textBody=r.observable(""),this.textBodyForNewWindow=r.observable(""),this.domTextBody=r.observable(null),this.rtlMessage=r.observable(!1),this.contentHasFocus=r.observable(!1),c.broadcastEvent("MailWebclient::RegisterMessagePaneController",i.bind((function(e,t){this.registerController(e,t)}),this)),this.fakeHeader=r.computed((function(){var e=!!i.find(this.topControllers(),(function(e){return!!e.visible&&e.visible()}));return!(this.visiblePicturesControl()||this.visibleConfirmationControl()||e)}),this),this.sAttachmentsSwitcherViewTemplate=c.isMobile()?"MailWebclient_Message_AttachmentsSwitcherView":"",this.sQuickReplyViewTemplate=c.isMobile()||!T.AllowQuickReply?"":"MailWebclient_Message_QuickReplyView",this.attachments=r.observableArray([]),this.notInlineAttachments=r.computed((function(){return i.filter(this.attachments(),(function(e){return!e.linked()}))}),this),this.notInlineAttachmentsInString=r.computed((function(){return i.map(this.notInlineAttachments(),(function(e){return e.fileName()}),this).join(", ")}),this),this.allAttachmentsDownloadMethods=r.observableArray([]),this.visibleDownloadAllAttachmentsSeparately=r.computed((function(){return this.notInlineAttachments().length>1}),this),this.visibleExtendedDownload=r.computed((function(){return this.visibleDownloadAllAttachmentsSeparately()||this.allAttachmentsDownloadMethods().length>0}),this),c.broadcastEvent("MailWebclient::AddAllAttachmentsDownloadMethod",i.bind((function(e){this.allAttachmentsDownloadMethods.push(e)}),this)),this.detailsVisible=r.observable(m.getData("aurora_mail_is-message-details-visible")),this.detailsTooltip=r.computed((function(){return this.detailsVisible()?n.i18n("COREWEBCLIENT/ACTION_HIDE_DETAILS"):n.i18n("COREWEBCLIENT/ACTION_SHOW_DETAILS")}),this),this.hasNotInlineAttachments=r.computed((function(){return this.notInlineAttachments().length>0}),this),this.hasBodyText=r.computed((function(){return this.textBody().length>0}),this),this.visibleAddMenu=r.observable(!1),this.replyText=r.observable(""),this.replyTextFocus=r.observable(!1),this.replyPaneVisible=r.computed((function(){return this.currentMessage()&&this.currentMessage().completelyFilled()}),this),this.replySendingStarted=r.observable(!1),this.replySavingStarted=r.observable(!1),this.replyAutoSavingStarted=r.observable(!1),this.requiresPostponedSending=r.observable(!1),this.replyAutoSavingStarted.subscribe((function(){!this.replyAutoSavingStarted()&&this.requiresPostponedSending()&&(C.sendPostponedMail(this.replyDraftUid()),this.requiresPostponedSending(!1))}),this),this.hasReplyAllCcAddrs=r.observable(!1),this.placeholderText=r.computed((function(){return this.hasReplyAllCcAddrs()?n.i18n("MAILWEBCLIENT/LABEL_QUICK_REPLY_ALL"):n.i18n("MAILWEBCLIENT/LABEL_QUICK_REPLY")}),this),this.sendButtonText=r.computed((function(){return this.hasReplyAllCcAddrs()?n.i18n("MAILWEBCLIENT/ACTION_SEND_ALL"):n.i18n("MAILWEBCLIENT/ACTION_SEND")}),this),r.computed((function(){(!this.replyTextFocus()||this.replyAutoSavingStarted()||this.replySavingStarted()||this.replySendingStarted())&&this.stopAutosaveTimer(),!this.replyTextFocus()||this.replyAutoSavingStarted()||this.replySavingStarted()||this.replySendingStarted()||this.startAutosaveTimer()}),this),this.saveButtonText=r.computed((function(){return this.replyAutoSavingStarted()?n.i18n("MAILWEBCLIENT/ACTION_SAVE_IN_PROGRESS"):n.i18n("MAILWEBCLIENT/ACTION_SAVE")}),this),this.replyDraftUid=r.observable(""),this.replyLoadingText=r.computed((function(){return this.replySendingStarted()?n.i18n("COREWEBCLIENT/INFO_SENDING"):this.replySavingStarted()?n.i18n("MAILWEBCLIENT/INFO_SAVING"):""}),this),this.isEnableSendQuickReply=r.computed((function(){return this.isCurrentMessageLoaded()&&""!==this.replyText()&&!this.replySendingStarted()}),this),this.isEnableSaveQuickReply=r.computed((function(){return this.isEnableSendQuickReply()&&!this.replySavingStarted()&&!this.replyAutoSavingStarted()}),this),this.saveQuickReplyCommand=h.createCommand(this,this.executeSaveQuickReply,this.isEnableSaveQuickReply),this.sendQuickReplyCommand=h.createCommand(this,this.executeSendQuickReply,this.isEnableSendQuickReply),this.domMessageHeader=r.observable(null),this.domQuickReply=r.observable(null),this.domMessageForPrint=r.observable(null),this.replyTextFocusThrottled=r.observable(!1).extend({throttle:50}),this.replyTextFocus.subscribe((function(){this.replyTextFocusThrottled(this.replyTextFocus())}),this),this.isQuickReplyActive=r.computed((function(){return this.replyText().length>0||this.replyTextFocusThrottled()}),this),this.visibleAttachments=r.observable(!1),this.showMessage=function(){this.visibleAttachments(!1)},this.showAttachments=function(){this.visibleAttachments(!0)},this.sDefaultFontName=T.DefaultFontName,d.registerDayOfMonthFunction(i.bind(this.updateMomentDate,this)),c.broadcastEvent("MailWebclient::ConstructView::after",{Name:"CMessagePaneView",View:this})}i.extendOwn(D.prototype,f.prototype),D.prototype.ViewTemplate=c.isNewTab()?"MailWebclient_MessagePaneScreenView":"MailWebclient_MessagePaneView",D.prototype.ViewConstructorName="CMessagePaneView",D.prototype.resizeDblClick=function(e,t){""!==t.target.className&&t.target.className.search(/add_contact|icon|link|title|subject|link|date|from/)&&(h.calmEvent(t),h.removeSelection(),this.expandMessagePaneWidth&&this.expandMessagePaneWidth(!this.expandMessagePaneWidth()))},D.prototype.notifySender=function(){if(this.currentMessage()&&""!==this.currentMessage().readingConfirmationAddressee()){var e=n.i18n("MAILWEBCLIENT/LABEL_RETURN_RECEIPT_MAIL_TEXT",{EMAIL:E.getEmail(),SUBJECT:this.subject()}).replace(/\\r\\n/g,"\n");F.send("SendMessage",{To:this.currentMessage().readingConfirmationAddressee(),Subject:n.i18n("MAILWEBCLIENT/LABEL_RETURN_RECEIPT_MAIL_SUBJECT"),Text:e,ConfirmFolder:this.currentMessage().folder(),ConfirmUid:this.currentMessage().longUid()}),this.currentMessage().readingConfirmationAddressee("")}},D.prototype.onFolderListSubscribe=function(){c.isNewTab()&&this.onMessagesSubscribe()},D.prototype.onMessagesSubscribe=function(){!this.currentMessage()&&this.uid()&&this.uid().length>0&&v.setCurrentMessage(this.accountId(),this.folder(),this.uid())},D.prototype.passReplyDataToNewTab=function(e){this.currentMessage()&&this.currentMessage().longUid()===e&&""!==this.replyText()&&(A.passReplyData(e,{ReplyText:this.replyText(),ReplyDraftUid:this.replyDraftUid()}),this.replyText(""),this.replyDraftUid(""))},D.prototype.onCurrentMessageSubscribe=function(){var e=this.currentMessage(),t=e?E.getAccount(e.accountId()):null,s=null;if(I&&e?(s=I.getReplyData(e.longUid()))&&(this.replyText(s.ReplyText),this.replyDraftUid(s.ReplyDraftUid)):e&&e.longUid()===this.displayedMessageUid()||(this.replyText(""),this.replyDraftUid("")),e&&this.uid()===e.uid()){if(this.hasReplyAllCcAddrs(C.hasReplyAllCcAddrs(e)),this.subject(e.subject()),this.importance(e.importance()),this.from(e.oFrom.getDisplay()),this.fromEmail(e.oFrom.getFirstEmail()),this.fullFrom(e.oFrom.getFull()),e.oFrom.aCollection.length>0?this.oFromAddr(e.oFrom.aCollection[0]):this.oFromAddr(null),this.to(e.oTo.getFull()),this.aToAddr(e.oTo.aCollection),this.cc(e.oCc.getFull()),this.aCcAddr(e.oCc.aCollection),this.bcc(e.oBcc.getFull()),this.aBccAddr(e.oBcc.aCollection),this.currentAccountEmail(t.email()),this.allRecipients(i.uniq(i.union(this.aToAddr(),this.aCcAddr(),this.aBccAddr()))),this.midDate(e.oDateModel.getMidDate()),this.fullDate(e.oDateModel.getFullDate()),this.isLoading(""!==e.longUid()&&!e.completelyFilled()),this.setMessageBody(),T.DisableRtlRendering||this.rtlMessage(e.rtl()),c.isNewTab()){var r=[];i.each(e.attachments(),i.bind((function(e){var t=new w(e.iAccountId);t.copyProperties(e),r.push(t)}),this)),this.attachments(r)}else this.attachments(e.attachments());if(!e.completelyFilled()||e.truncated()){var n=e.completelyFilled()?e.truncated:e.completelyFilled;c.isNewTab()?e.completelyFilledNewTabSubscription=n.subscribe(this.onCurrentMessageSubscribe,this):e.completelyFilledSubscription=n.subscribe(this.onCurrentMessageSubscribe,this)}else e.completelyFilledSubscription?(e.completelyFilledSubscription.dispose(),e.completelyFilledSubscription=void 0):e.completelyFilledNewTabSubscription&&(e.completelyFilledNewTabSubscription.dispose(),e.completelyFilledNewTabSubscription=void 0)}else this.hasReplyAllCcAddrs(!1),this.isLoading(!1),o(this.domTextBody()).empty().data("displayed-message-uid",""),this.displayedMessageUid(""),this.rtlMessage(!1),this.attachments([]),this.visiblePicturesControl(!1),this.visibleShowPicturesLink(!1);this.doAfterPopulatingMessage()},D.prototype.updateMomentDate=function(){var e=this.currentMessage();e&&e.oDateModel&&(this.midDate(e.oDateModel.getMidDate()),this.fullDate(e.oDateModel.getFullDate()))},D.prototype.setMessageBody=function(){if(this.currentMessage()){var e=this.currentMessage(),t=e.text(),s=o(this.domTextBody()),i=null,r="",a=t.length,l=[];this.textBody(t),s.data("displayed-message-uid")===e.longUid()&&(l=this.getBlockquotesStatus()),s.empty(),e.isPlain()||a>5e6?(s.html(t),this.visiblePicturesControl(!1)):(r=(i=e.getDomText()).length>0?i.html():"",s.append(r),this.visiblePicturesControl(e.hasExternals()&&!e.isExternalsAlwaysShown()),this.visibleShowPicturesLink(!e.isExternalsShown()),n.htmlStartsWithBlockquote(r)||this.doHidingBlockquotes(l)),s.data("displayed-message-uid",e.longUid()),this.displayedMessageUid(e.longUid())}},D.prototype.getBlockquotesStatus=function(){var e=[];return o(o("blockquote",o(this.domTextBody())).get()).each((function(){var t=o(this);t.hasClass("blockquote_before_toggle")&&e.push(t.hasClass("collapsed"))})),e},D.prototype.doHidingBlockquotes=function(e){var t=0;o(o("blockquote",o(this.domTextBody())).get()).each((function(){var s=o(this),i=s.parents("blockquote"),r=o('<span class="blockquote_toggle"></span>').html(n.i18n("MAILWEBCLIENT/ACTION_SHOW_QUOTED_TEXT")),a=!0;0===i.length&&s.height()>120&&(s.addClass("blockquote_before_toggle").after(r).wrapInner('<div class="blockquote_content"></div>'),r.bind("click",(function(){a?(s.height("auto"),r.html(n.i18n("MAILWEBCLIENT/ACTION_HIDE_QUOTED_TEXT")),a=!1):(s.height(80),r.html(n.i18n("MAILWEBCLIENT/ACTION_SHOW_QUOTED_TEXT")),a=!0),s.toggleClass("collapsed",a)})),t<e.length&&(a=e[t],t++),s.height(a?80:"auto").toggleClass("collapsed",a))}))},D.prototype.onRoute=function(e){var t=S.parseMailbox(e),s=t.Folder,i=t.Uid,o=v.getMessageActualIdentifiers(v.currentAccountId(),s,i);E.changeCurrentAccountByHash(t.AccountHash),""!==this.replyText()&&this.uid()!==o.sUid&&this.saveReplyMessage(!1),this.accountId(o.iAccountId),this.uid(o.sUid),this.folder(o.sFolder),v.setCurrentMessage(o.iAccountId,o.sFolder,o.sUid),c.isNewTab&&v.setCurrentFolder(t.Folder,t.Filters),this.contentHasFocus(!0)},D.prototype.showPictures=function(){v.showExternalPictures(!1),this.visibleShowPicturesLink(!1),this.setMessageBody()},D.prototype.alwaysShowPictures=function(){var e=this.currentMessage()?this.currentMessage().oFrom.getFirstEmail():"";e.length>0&&F.send("SetEmailSafety",{Email:e}),v.showExternalPictures(!0),this.visiblePicturesControl(!1),this.setMessageBody()},D.prototype.openInNewWindow=function(){this.openMessageInNewWindowBound(this.currentMessage())},D.prototype.getReplyHtmlText=function(){return'<div style="font-family: '+this.sDefaultFontName+'; font-size: 16px">'+C.getHtmlFromText(this.replyText())+"</div>"},D.prototype.executeReplyOrForward=function(e){this.currentMessage()&&(C.setReplyData(this.getReplyHtmlText(),this.replyDraftUid()),this.replyText(""),this.replyDraftUid(""),y.composeMessageAsReplyOrForward(e,this.currentMessage().accountId(),this.currentMessage().folder(),this.currentMessage().longUid()))},D.prototype.executeDeleteMessage=function(){this.currentMessage()&&(I?I.deleteMessage(this.currentMessage().longUid(),(function(){window.close()})):c.isMobile()&&M.deleteMessages([this.currentMessage().longUid()],c))},D.prototype.executePrevMessage=function(){this.isEnablePrevMessage()&&p.setHash(S.getViewMessage(v.currentAccountId(),v.getCurrentFolderFullname(),this.prevMessageUid()))},D.prototype.executeNextMessage=function(){this.isEnableNextMessage()&&p.setHash(S.getViewMessage(v.currentAccountId(),v.getCurrentFolderFullname(),this.nextMessageUid()))},D.prototype.executeReply=function(){this.executeReplyOrForward(Enums.ReplyType.Reply)},D.prototype.executeReplyAll=function(){this.executeReplyOrForward(Enums.ReplyType.ReplyAll)},D.prototype.executeResend=function(){this.executeReplyOrForward(Enums.ReplyType.Resend)},D.prototype.executeForward=function(){this.executeReplyOrForward(Enums.ReplyType.Forward)},D.prototype.executePrint=function(){var e=this.currentMessage(),t=e?b.open("",this.subject()+"-print"):null,s="";e&&t&&(this.textBodyForNewWindow(e.getConvertedHtml(l.getAppPath(),!0)),s=o(this.domMessageForPrint()).html(),t.document.title=this.subject(),o(t.document.body).html(s),t.print())},D.prototype.executeSave=function(){this.isEnableSave()&&this.currentMessage()&&l.downloadByUrl(this.currentMessage().sDownloadAsEmlUrl,!0)},D.prototype.executeForwardAsAttachment=function(){this.currentMessage()&&y.composeMessageWithEml(this.currentMessage())},D.prototype.changeAddMenuVisibility=function(){var e=!this.visibleAddMenu();this.visibleAddMenu(e)},D.prototype.onSendOrSaveMessageResponse=function(e,t){var s=C.onSendOrSaveMessageResponse(e,t,this.requiresPostponedSending());switch(s.Method){case"SendMessage":this.replySendingStarted(!1),s.Result&&this.replyText("");break;case"SaveMessage":s.Result&&this.replyDraftUid(s.NewUid),this.replySavingStarted(!1),this.replyAutoSavingStarted(!1)}},D.prototype.executeSendQuickReply=function(){this.isEnableSendQuickReply()&&(this.replySendingStarted(!0),this.requiresPostponedSending(this.replyAutoSavingStarted()),C.sendReplyMessage("SendMessage",this.getReplyHtmlText(),this.replyDraftUid(),this.onSendOrSaveMessageResponse,this,this.requiresPostponedSending()),this.replyTextFocus(!1))},D.prototype.executeSaveQuickReply=function(){this.saveReplyMessage(!1)},D.prototype.saveReplyMessage=function(e){this.isEnableSaveQuickReply()&&(e?this.replyAutoSavingStarted(!0):this.replySavingStarted(!0),C.sendReplyMessage("SaveMessage",this.getReplyHtmlText(),this.replyDraftUid(),this.onSendOrSaveMessageResponse,this))},D.prototype.stopAutosaveTimer=function(){window.clearTimeout(this.autoSaveTimer)},D.prototype.startAutosaveTimer=function(){if(this.isEnableSaveQuickReply()){var e=i.bind(this.saveReplyMessage,this,!0);this.stopAutosaveTimer(),T.AllowAutosaveInDrafts&&(this.autoSaveTimer=window.setTimeout(e,1e3*T.AutoSaveIntervalSeconds))}},D.prototype.executeAllAttachmentsDownloadMethod=function(e){const t=this.currentMessage();if(t){const s=t.notInlineAttachments(),i=s.map((e=>e.hash()));e(t.accountId(),i,s)}},D.prototype.downloadAllAttachmentsSeparately=function(){this.currentMessage()&&this.currentMessage().downloadAllAttachmentsSeparately()},D.prototype.onShow=function(){this.bShown=!0},D.prototype.onHide=function(){this.bShown=!1,this.accountId(0),this.folder(""),this.uid(""),i.each(this.controllers(),i.bind((function(e){i.isFunction(e.onHide)&&e.onHide()}),this))},D.prototype.onBind=function(e){u.run("SessionTimeoutWeblient","registerFunction",[i.bind((function(){""!==this.replyText()&&this.saveReplyMessage(!1)}),this)]),this.$MailViewDom=i.isUndefined(e)?this.$viewDom:e,this.$MailViewDom.on("mousedown","a",(function(e){if(e&&3!==e.which){var t=o(this).attr("href");if(t&&"mailto:"===t.toString().toLowerCase().substr(0,7))return y.composeMessageToAddresses(t.toString()),!1}return!0})),c.isMobile()||this.hotKeysBind()},D.prototype.hotKeysBind=function(){o(document).on("keydown",o.proxy((function(e){const t=this.bShown&&e&&!(e.ctrlKey||e.metaKey)&&!e.shiftKey&&!h.isTextFieldFocused()&&this.isEnableReply();t&&e.keyCode===Enums.Key.q?(e.preventDefault(),this.replyTextFocus(!0)):t&&e.keyCode===Enums.Key.r&&(e.preventDefault(),this.executeReply())}),this))},D.prototype.showSourceHeaders=function(){var e=this.currentMessage(),t=e&&e.completelyFilled()?b.open("",this.subject()+"-headers"):null;t&&o(t.document.body).html("<pre>"+n.encodeHtml(e.sourceHeaders())+"</pre>")},D.prototype.switchDetailsVisibility=function(){this.detailsVisible(!this.detailsVisible()),m.setData("aurora_mail_is-message-details-visible",this.detailsVisible())},D.prototype.registerController=function(e,t){switch(t){case"OnMessageToolbar":this.messageToolbarControllers.push(e);break;case"BeforeMessageHeaders":this.topControllers.push(e);break;case"BeforeMessageBody":this.bodyControllers.push(e);break;case"AfterMessageBody":this.bottomControllers.push(e)}i.isFunction(e.assignMessagePaneExtInterface)&&e.assignMessagePaneExtInterface(this.getExtInterface())},D.prototype.getExtInterface=function(){return{changeText:i.bind((function(e){var t=this.currentMessage();t&&this.isCurrentMessageLoaded()&&(t.changeText(e),this.setMessageBody())}),this)}},D.prototype.doAfterPopulatingMessage=function(){var e=this.currentMessage(),t=e&&!this.isLoading()?{iAccountId:e.accountId(),sFolderFullName:e.folder(),sMessageUid:e.uid(),aToEmails:e.oTo.getEmails(),bPlain:e.isPlain(),sRawText:e.textRaw(),sText:e.text(),sAccountEmail:E.getEmail(e.accountId()),sFromEmail:e.oFrom.getFirstEmail(),iSensitivity:e.sensitivity(),aExtend:e.aExtend}:null;i.each(this.controllers(),i.bind((function(e){i.isFunction(e.doAfterPopulatingMessage)&&e.doAfterPopulatingMessage(t)}),this)),u.run("ContactsWebclient","applyContactsCards",[this.$MailViewDom.find("span.address")])},D.prototype.searchBySubject=function(){if(T.AllowSearchMessagesBySubject&&this.currentMessage()){var e=this.currentMessage().folder(),t=this.currentMessage().longUid(),s="",r=this.currentMessage().subject().split(":"),n=T.PrefixesToRemoveBeforeSearchMessagesBySubject,a=[];0===n.length?s=r:(i.each(r,(function(e){if(a.length>0)a.push(e);else{var t=!1,s=o.trim(e);i.each(n,(function(e){var i=new RegExp("^"+e+"(\\[\\d*\\]){0,1}$","i");t=t||i.test(s)})),t||a.push(e)}})),s=o.trim(a.join(":"))),p.setHash(S.getMailbox(e,1,t,s,""))}},e.exports=new D},nWzW:(e,t,s)=>{"use strict";const i=s("a7T2"),o=s("p09A"),r=s("H20a"),n=s("KC/L"),a=s("/QeJ"),l=s("XeMN"),h=s("oUN1"),c=s("skxT"),u=s("CPab"),d=s("QaEg"),p=s("F0Fd");function m(){this.unsubscribeOneClick=o.observable(!1),this.unsubscribeUrl=o.observable(""),this.unsubscribeEmail=o.observable(""),this.allowUnsubscribe=o.observable(!1),o.computed((function(){const e=p.currentMessage();e&&e.completelyFilled()&&(this.unsubscribeOneClick(n.pBool(e.unsubscribe.OneClick)),this.unsubscribeUrl(n.pString(e.unsubscribe.Url)),this.unsubscribeEmail(n.pString(e.unsubscribe.Email)),this.allowUnsubscribe(this.unsubscribeOneClick()||""!==this.unsubscribeUrl()||""!==this.unsubscribeEmail()))}),this).extend({rateLimit:100})}m.prototype.ViewTemplate="MailWebclient_Message_UnsubscribeButtonView",m.prototype.unsubscribe=function(){const e=p.currentMessage();if(e)if(this.unsubscribeOneClick()){const t={AccountID:e.accountId(),Folder:e.folder(),Uid:e.uid()};d.send("Unsubscribe",t,this.onUnsubscribeResponse,this)}else this.unsubscribeEmail()?this.unsubscribeWithEmail():this.unsubscribeUrl()&&window.open(this.unsubscribeUrl(),"_blank")},m.prototype.onUnsubscribeResponse=function(e,t){e&&e.Result?c.showReport(r.i18n("MAILWEBCLIENT/REPORT_UNSUBSCRIBE_MESSAGE_SUCCESS")):a.showErrorByCode(e,r.i18n("MAILWEBCLIENT/ERROR_UNSUBSCRIBE_MESSAGE_FAIL"))},m.prototype.unsubscribeWithEmail=function(){const e=u.parseToAddr(this.unsubscribeEmail()),t={RECIPIENT:i.compact([e.to,e.cc,e.bcc]).join(", "),SUBJECT:e.subject},s=e.subject?r.i18n("MAILWEBCLIENT/CONFIRM_UNSUBSCRIBE_WITH_EMAIL_AND_SUBJECT",t):r.i18n("MAILWEBCLIENT/CONFIRM_UNSUBSCRIBE_WITH_EMAIL",t),o=r.i18n("MAILWEBCLIENT/ACTION_SEND");h.showPopup(l,[s,t=>{t&&this.sendUnsubscribeEmail(e)},"",o])},m.prototype.sendUnsubscribeEmail=function(e){const t={To:e.to,Cc:e.cc,Bcc:e.bcc,Subject:e.subject,Text:e.body};d.send("SendMessage",t,this.onUnsubscribeResponse,this)},e.exports=new m},ixCM:(e,t,s)=>{"use strict";const i=s("p09A"),o=s("H20a"),r=s("REt5"),n=s("QaEg"),a=s("/QeJ"),l=s("skxT"),h=s("7xgn"),c=s("F0Fd");function u(){this.allowSpamButtons=i.observable(!1),this.isCurrentMessageLoaded=i.observable(!1),this.neverSpamCommand=r.createCommand(this,this.neverSpam,this.isCurrentMessageLoaded),this.alwaysSpamCommand=r.createCommand(this,this.alwaysSpam,this.isCurrentMessageLoaded)}u.prototype.ViewTemplate="MailWebclient_Message_SpamButtonsView",u.prototype.doAfterPopulatingMessage=function(e){const t=c.currentMessage(),s=t?h.getAccount(t.accountId()):h.getCurrent(),i=!!s&&s.enableAllowBlockLists(),o=c.isTemplateFolder(t&&t.folder());this.allowSpamButtons(i&&!o),this.isCurrentMessageLoaded(!!e)},u.prototype.neverSpam=function(){const e=c.currentMessage().oFrom.getFirstEmail(),t={AccountID:h.editedId(),Email:e};n.send("AddEmailToAllowList",t,(function(t){t&&t.Result?l.showReport(o.i18n("MAILWEBCLIENT/REPORT_ADD_EMAIL_TO_ALLOWLIST_SUCCESS",{EMAIL:e})):a.showErrorByCode(t,o.i18n("MAILWEBCLIENT/ERROR_ADD_EMAIL_TO_ALLOWLIST",{EMAIL:e}))}),this)},u.prototype.alwaysSpam=function(){var e=c.currentMessage().oFrom.getFirstEmail(),t={AccountID:h.editedId(),Email:e};n.send("AddEmailToBlockList",t,(function(t){t&&t.Result?l.showReport(o.i18n("MAILWEBCLIENT/REPORT_ADD_EMAIL_TO_BLOCKLIST_SUCCESS",{EMAIL:e})):a.showErrorByCode(t,o.i18n("MAILWEBCLIENT/ERROR_ADD_EMAIL_TO_BLOCKLIST",{EMAIL:e}))}),this)},e.exports=new u}}]);